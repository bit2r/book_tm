<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 자료2: 크롤링 | 텍스트마이닝</title>
  <meta name="description" content="Chapter 7 자료2: 크롤링 | 텍스트마이닝 준비" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 자료2: 크롤링 | 텍스트마이닝" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 7 자료2: 크롤링 | 텍스트마이닝 준비" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 자료2: 크롤링 | 텍스트마이닝" />
  
  <meta name="twitter:description" content="Chapter 7 자료2: 크롤링 | 텍스트마이닝 준비" />
  

<meta name="author" content="안도현" />


<meta name="date" content="2021-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="anal1freq.html"/>
<link rel="next" href="clean2.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">데이터커뮤니케이션:텍스트마이닝</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#머리말"><i class="fa fa-check"></i><b>0.1</b> 머리말</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#이책의-구성"><i class="fa fa-check"></i><b>0.2</b> 이책의 구성</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#이책에서-다루지-않은-주제"><i class="fa fa-check"></i><b>0.3</b> 이책에서 다루지 않은 주제</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#도움받은-자료"><i class="fa fa-check"></i><b>0.4</b> 도움받은 자료</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>Author</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 도입</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#사회과학-방법론"><i class="fa fa-check"></i><b>1.1</b> 사회과학 방법론</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#내용분석content-analysis"><i class="fa fa-check"></i><b>1.2</b> 내용분석(Content Analysis)</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#내용분석의-정의"><i class="fa fa-check"></i><b>1.2.1</b> 내용분석의 정의</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#컴퓨터보조-내용분석"><i class="fa fa-check"></i><b>1.2.2</b> 컴퓨터보조 내용분석</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#근거이론grounded-theory"><i class="fa fa-check"></i><b>1.2.3</b> 근거이론(grounded theory)</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#컴퓨터-기반-근거이론"><i class="fa fa-check"></i><b>1.2.4</b> 컴퓨터 기반 근거이론</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#전산사회과학computational-social-science-디지털인문학digital-humanities"><i class="fa fa-check"></i><b>1.2.5</b> 전산사회과학(Computational Social Science) 디지털인문학(Digital Humanities)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#텍스트마이닝"><i class="fa fa-check"></i><b>1.3</b> 텍스트마이닝</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#텍스트데이터"><i class="fa fa-check"></i><b>1.4</b> 텍스트데이터</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#텍스트의-단위"><i class="fa fa-check"></i><b>1.4.1</b> 텍스트의 단위</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prep.html"><a href="prep.html"><i class="fa fa-check"></i><b>2</b> 준비</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prep.html"><a href="prep.html#컴퓨터-인터넷"><i class="fa fa-check"></i><b>2.1</b> 컴퓨터 / 인터넷</a></li>
<li class="chapter" data-level="2.2" data-path="prep.html"><a href="prep.html#r-r-studio"><i class="fa fa-check"></i><b>2.2</b> R / R Studio</a></li>
<li class="chapter" data-level="2.3" data-path="prep.html"><a href="prep.html#패키지package"><i class="fa fa-check"></i><b>2.3</b> 패키지(Package)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prep.html"><a href="prep.html#tidyverse"><i class="fa fa-check"></i><b>2.3.1</b> tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prep.html"><a href="prep.html#오류error"><i class="fa fa-check"></i><b>2.4</b> 오류(error)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="prep.html"><a href="prep.html#패키지-설치시-겪을-수-있는-오류"><i class="fa fa-check"></i><b>2.4.1</b> 패키지 설치시 겪을 수 있는 오류</a></li>
<li class="chapter" data-level="2.4.2" data-path="prep.html"><a href="prep.html#실행할-때-겪을-수-있는-오류"><i class="fa fa-check"></i><b>2.4.2</b> 실행할 때 겪을 수 있는 오류</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="prep.html"><a href="prep.html#여러-패키지-한번에-설치"><i class="fa fa-check"></i><b>2.5</b> 여러 패키지 한번에 설치</a></li>
<li class="chapter" data-level="2.6" data-path="prep.html"><a href="prep.html#코딩-스타일"><i class="fa fa-check"></i><b>2.6</b> 코딩 스타일</a></li>
<li class="chapter" data-level="2.7" data-path="prep.html"><a href="prep.html#파일경로path-표시"><i class="fa fa-check"></i><b>2.7</b> 파일경로(path) 표시</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="prep.html"><a href="prep.html#슬래시"><i class="fa fa-check"></i><b>2.7.1</b> 슬래시 /</a></li>
<li class="chapter" data-level="2.7.2" data-path="prep.html"><a href="prep.html#마침표-.-.."><i class="fa fa-check"></i><b>2.7.2</b> 마침표 . ..</a></li>
<li class="chapter" data-level="2.7.3" data-path="prep.html"><a href="prep.html#물결"><i class="fa fa-check"></i><b>2.7.3</b> 물결 ~</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="prep.html"><a href="prep.html#파일과-객체"><i class="fa fa-check"></i><b>2.8</b> 파일과 객체</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="prep.html"><a href="prep.html#하드디스크에-있는-파일을-다루는-함수"><i class="fa fa-check"></i><b>2.8.1</b> 하드디스크에 있는 파일을 다루는 함수</a></li>
<li class="chapter" data-level="2.8.2" data-path="prep.html"><a href="prep.html#r환경내-객체를-다루는-함수"><i class="fa fa-check"></i><b>2.8.2</b> R환경내 객체를 다루는 함수</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="prep.html"><a href="prep.html#따옴표와-백틱"><i class="fa fa-check"></i><b>2.9</b> 따옴표와 백틱</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="prep.html"><a href="prep.html#겹따옴표-홑따옴표"><i class="fa fa-check"></i><b>2.9.1</b> 겹따옴표 홑따옴표</a></li>
<li class="chapter" data-level="2.9.2" data-path="prep.html"><a href="prep.html#백틱backquotebacktick"><i class="fa fa-check"></i><b>2.9.2</b> 백틱(backquote/backtick) `</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="prep.html"><a href="prep.html#주의중요"><i class="fa fa-check"></i><b>2.10</b> 주의(중요)</a></li>
<li class="chapter" data-level="2.11" data-path="prep.html"><a href="prep.html#흔한-오류"><i class="fa fa-check"></i><b>2.11</b> 흔한 오류</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="prep.html"><a href="prep.html#오자와-탈자."><i class="fa fa-check"></i><b>2.11.1</b> 오자와 탈자.</a></li>
<li class="chapter" data-level="2.11.2" data-path="prep.html"><a href="prep.html#괄호의-불일치"><i class="fa fa-check"></i><b>2.11.2</b> 괄호의 불일치</a></li>
<li class="chapter" data-level="2.11.3" data-path="prep.html"><a href="prep.html#보이지-않는-코드"><i class="fa fa-check"></i><b>2.11.3</b> 보이지 않는 코드</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="browse.html"><a href="browse.html"><i class="fa fa-check"></i><b>3</b> 틀잡기</a>
<ul>
<li class="chapter" data-level="3.1" data-path="browse.html"><a href="browse.html#자료"><i class="fa fa-check"></i><b>3.1</b> 자료</a></li>
<li class="chapter" data-level="3.2" data-path="browse.html"><a href="browse.html#정제"><i class="fa fa-check"></i><b>3.2</b> 정제</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="browse.html"><a href="browse.html#정돈텍스트tidy-text"><i class="fa fa-check"></i><b>3.2.1</b> 정돈텍스트(tidy text)</a></li>
<li class="chapter" data-level="3.2.2" data-path="browse.html"><a href="browse.html#토큰화-unnest_tokens-함수"><i class="fa fa-check"></i><b>3.2.2</b> 토큰화: <code>unnest_tokens</code> 함수</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="browse.html"><a href="browse.html#분석"><i class="fa fa-check"></i><b>3.3</b> 분석</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="browse.html"><a href="browse.html#빈도-count-함수"><i class="fa fa-check"></i><b>3.3.1</b> 빈도: <code>count</code> 함수</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="browse.html"><a href="browse.html#소통"><i class="fa fa-check"></i><b>3.4</b> 소통</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="browse.html"><a href="browse.html#시각화"><i class="fa fa-check"></i><b>3.4.1</b> 시각화</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="browse.html"><a href="browse.html#연습"><i class="fa fa-check"></i><b>3.5</b> 연습</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="browse.html"><a href="browse.html#과제"><i class="fa fa-check"></i><b>3.5.1</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data1.html"><a href="data1.html"><i class="fa fa-check"></i><b>4</b> 자료1: 불러오기</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data1.html"><a href="data1.html#바이너리-파일"><i class="fa fa-check"></i><b>4.1</b> 바이너리 파일</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data1.html"><a href="data1.html#불러오기이입-import"><i class="fa fa-check"></i><b>4.1.1</b> 불러오기(이입: import)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data1.html"><a href="data1.html#일반텍스트plain-text-파일"><i class="fa fa-check"></i><b>4.2</b> 일반텍스트(plain text) 파일</a></li>
<li class="chapter" data-level="4.3" data-path="data1.html"><a href="data1.html#html-파일"><i class="fa fa-check"></i><b>4.3</b> HTML 파일</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data1.html"><a href="data1.html#html문서-불러오기-read_html"><i class="fa fa-check"></i><b>4.3.1</b> HTML문서 불러오기 <code>read_html()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="data1.html"><a href="data1.html#htlm요소-추출하기-html_node"><i class="fa fa-check"></i><b>4.3.2</b> HTLM요소 추출하기 <code>html_node()</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="data1.html"><a href="data1.html#내용-추출하기-html_text"><i class="fa fa-check"></i><b>4.3.3</b> 내용 추출하기 <code>html_text</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data1.html"><a href="data1.html#내보내기export-이출"><i class="fa fa-check"></i><b>4.4</b> 내보내기(export: 이출)</a></li>
<li class="chapter" data-level="4.5" data-path="data1.html"><a href="data1.html#인코딩encoding-부호화"><i class="fa fa-check"></i><b>4.5</b> 인코딩(encoding: 부호화)</a></li>
<li class="chapter" data-level="4.6" data-path="data1.html"><a href="data1.html#테이블구조-문서"><i class="fa fa-check"></i><b>4.6</b> 테이블구조 문서</a></li>
<li class="chapter" data-level="4.7" data-path="data1.html"><a href="data1.html#기타-파일-형식"><i class="fa fa-check"></i><b>4.7</b> 기타 파일 형식</a></li>
<li class="chapter" data-level="4.8" data-path="data1.html"><a href="data1.html#연습-1"><i class="fa fa-check"></i><b>4.8</b> 연습</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="data1.html"><a href="data1.html#과제-1"><i class="fa fa-check"></i><b>4.8.1</b> 과제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clean1.html"><a href="clean1.html"><i class="fa fa-check"></i><b>5</b> 정제1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clean1.html"><a href="clean1.html#토큰화"><i class="fa fa-check"></i><b>5.1</b> 토큰화</a></li>
<li class="chapter" data-level="5.2" data-path="clean1.html"><a href="clean1.html#불용어stop-words"><i class="fa fa-check"></i><b>5.2</b> 불용어(stop words)</a></li>
<li class="chapter" data-level="5.3" data-path="clean1.html"><a href="clean1.html#unnest_tokens함수-용법"><i class="fa fa-check"></i><b>5.3</b> <code>unnest_tokens</code>함수 용법</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anal1freq.html"><a href="anal1freq.html"><i class="fa fa-check"></i><b>6</b> 분석1: 빈도</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anal1freq.html"><a href="anal1freq.html#단어빈도"><i class="fa fa-check"></i><b>6.1</b> 단어빈도</a></li>
<li class="chapter" data-level="6.2" data-path="anal1freq.html"><a href="anal1freq.html#kiwc"><i class="fa fa-check"></i><b>6.2</b> KIWC</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data2-crawl.html"><a href="data2-crawl.html"><i class="fa fa-check"></i><b>7</b> 자료2: 크롤링</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data2-crawl.html"><a href="data2-crawl.html#개관"><i class="fa fa-check"></i><b>7.1</b> 개관</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data2-crawl.html"><a href="data2-crawl.html#웹-작동방식"><i class="fa fa-check"></i><b>7.1.1</b> 웹 작동방식</a></li>
<li class="chapter" data-level="7.1.2" data-path="data2-crawl.html"><a href="data2-crawl.html#연습-2"><i class="fa fa-check"></i><b>7.1.2</b> 연습</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data2-crawl.html"><a href="data2-crawl.html#http요청과-응답-httr"><i class="fa fa-check"></i><b>7.2</b> HTTP요청과 응답 <code>httr</code></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="data2-crawl.html"><a href="data2-crawl.html#get-방식"><i class="fa fa-check"></i><b>7.2.1</b> GET 방식</a></li>
<li class="chapter" data-level="7.2.2" data-path="data2-crawl.html"><a href="data2-crawl.html#post방식"><i class="fa fa-check"></i><b>7.2.2</b> POST방식</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data2-crawl.html"><a href="data2-crawl.html#텍스트-추출-rvest"><i class="fa fa-check"></i><b>7.3</b> 텍스트 추출 <code>rvest</code></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data2-crawl.html"><a href="data2-crawl.html#html문서-불러오기"><i class="fa fa-check"></i><b>7.3.1</b> HTML문서 불러오기</a></li>
<li class="chapter" data-level="7.3.2" data-path="data2-crawl.html"><a href="data2-crawl.html#html요소-추출"><i class="fa fa-check"></i><b>7.3.2</b> HTML요소 추출</a></li>
<li class="chapter" data-level="7.3.3" data-path="data2-crawl.html"><a href="data2-crawl.html#html요소에서-내용-추출"><i class="fa fa-check"></i><b>7.3.3</b> HTML요소에서 내용 추출</a></li>
<li class="chapter" data-level="7.3.4" data-path="data2-crawl.html"><a href="data2-crawl.html#user-agent-지정"><i class="fa fa-check"></i><b>7.3.4</b> User-Agent 지정</a></li>
<li class="chapter" data-level="7.3.5" data-path="data2-crawl.html"><a href="data2-crawl.html#연습1"><i class="fa fa-check"></i><b>7.3.5</b> 연습1</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data2-crawl.html"><a href="data2-crawl.html#api"><i class="fa fa-check"></i><b>7.4</b> API</a></li>
<li class="chapter" data-level="7.5" data-path="data2-crawl.html"><a href="data2-crawl.html#반복작업-for"><i class="fa fa-check"></i><b>7.5</b> 반복작업 <code>for</code></a></li>
<li class="chapter" data-level="7.6" data-path="data2-crawl.html"><a href="data2-crawl.html#동적웹페이지-rselenium"><i class="fa fa-check"></i><b>7.6</b> 동적웹페이지 <code>RSelenium</code></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="data2-crawl.html"><a href="data2-crawl.html#r셀레니움-사용-준비"><i class="fa fa-check"></i><b>7.6.1</b> R셀레니움 사용 준비</a></li>
<li class="chapter" data-level="7.6.2" data-path="data2-crawl.html"><a href="data2-crawl.html#r셀레늄으로-브라우징"><i class="fa fa-check"></i><b>7.6.2</b> R셀레늄으로 브라우징</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="clean2.html"><a href="clean2.html"><i class="fa fa-check"></i><b>8</b> 정제2: 형태소</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="clean2.html"><a href="clean2.html#mecab"><i class="fa fa-check"></i><b>8.0.1</b> MeCab</a></li>
<li class="chapter" data-level="8.1" data-path="clean2.html"><a href="clean2.html#rccpmecab"><i class="fa fa-check"></i><b>8.1</b> RccpMeCab</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="anal2comp.html"><a href="anal2comp.html"><i class="fa fa-check"></i><b>9</b> 분석2: 비교</a>
<ul>
<li class="chapter" data-level="9.1" data-path="anal2comp.html"><a href="anal2comp.html#오즈비"><i class="fa fa-check"></i><b>9.1</b> 오즈비</a></li>
<li class="chapter" data-level="9.2" data-path="anal2comp.html"><a href="anal2comp.html#tf-idf"><i class="fa fa-check"></i><b>9.2</b> tf-idf</a></li>
<li class="chapter" data-level="9.3" data-path="anal2comp.html"><a href="anal2comp.html#사전"><i class="fa fa-check"></i><b>9.3</b> 사전</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="anal2comp.html"><a href="anal2comp.html#정서분석"><i class="fa fa-check"></i><b>9.3.1</b> 정서분석</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anal3cor.html"><a href="anal3cor.html"><i class="fa fa-check"></i><b>10</b> 분석3: 상관</a>
<ul>
<li class="chapter" data-level="10.1" data-path="anal3cor.html"><a href="anal3cor.html#상관분석"><i class="fa fa-check"></i><b>10.1</b> 상관분석</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anal3topic.html"><a href="anal3topic.html"><i class="fa fa-check"></i><b>11</b> 주제모형(topic modeling)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="anal3topic.html"><a href="anal3topic.html#주제모형"><i class="fa fa-check"></i><b>11.1</b> 주제모형</a></li>
<li class="chapter" data-level="11.2" data-path="anal3topic.html"><a href="anal3topic.html#비지도학습"><i class="fa fa-check"></i><b>11.2</b> 비지도학습</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="anal3topic.html"><a href="anal3topic.html#군집분석"><i class="fa fa-check"></i><b>11.2.1</b> 군집분석</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="anal3topic.html"><a href="anal3topic.html#반지도학습"><i class="fa fa-check"></i><b>11.3</b> 반지도학습</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="anal4network.html"><a href="anal4network.html"><i class="fa fa-check"></i><b>12</b> 연결망 분석</a>
<ul>
<li class="chapter" data-level="12.1" data-path="anal4network.html"><a href="anal4network.html#tidygraph"><i class="fa fa-check"></i><b>12.1</b> tidygraph</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="comm.html"><a href="comm.html"><i class="fa fa-check"></i><b>13</b> 소통</a>
<ul>
<li class="chapter" data-level="13.1" data-path="comm.html"><a href="comm.html#시각화-1"><i class="fa fa-check"></i><b>13.1</b> 시각화</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="comm.html"><a href="comm.html#한글-폰트-설정"><i class="fa fa-check"></i><b>13.1.1</b> 한글 폰트 설정</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="comm.html"><a href="comm.html#마크다운"><i class="fa fa-check"></i><b>13.2</b> 마크다운</a></li>
<li class="chapter" data-level="13.3" data-path="comm.html"><a href="comm.html#샤이니"><i class="fa fa-check"></i><b>13.3</b> 샤이니</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="case1.html"><a href="case1.html"><i class="fa fa-check"></i><b>14</b> 사례연구1</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case1.html"><a href="case1.html#사례1"><i class="fa fa-check"></i><b>14.1</b> 사례1</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="case2.html"><a href="case2.html"><i class="fa fa-check"></i><b>15</b> 사례연구2</a>
<ul>
<li class="chapter" data-level="15.1" data-path="case2.html"><a href="case2.html#사례1-1"><i class="fa fa-check"></i><b>15.1</b> 사례1</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="case3.html"><a href="case3.html"><i class="fa fa-check"></i><b>16</b> 사례연구3</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">텍스트마이닝</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data2_crawl" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> 자료2: 크롤링</h1>
<p>크롤링(crawling)은 소프트웨어 등이 웹을 돌아다니며 필요한 정보를 찾아 수집해 오는 작업이다. 일반적으로 웹 크롤링이라고 하면 구글과 같은 검색엔진이 사용자가 검색하기 전에 수천억개에 달하는 웹페이지 정보를 수집해 검색 색인에 정리하는 작업을 말하지만, 일반 사용자들이 필요한 정보를 소규모로 수집하는 작업도 크롤링이라고 한다.</p>
<p>여러 웹페이지를 돌아다니며(crawling) 수집한다는 점에서 크롤링이라고 한다. 웹페이지의 정보를 긁어 온다(scraping)는 의미에서 스크래핑이라고도 한다.</p>
<p>일반 사용자가 크롤링을 하는 이유는 효율 때문이다. 소규모라도 사람이 수작업으로 하기에는 많은 양을 다룰 때 크롤링한다. 예를 들어, 지난 1년간 특정 주제어가 등장하는 주요 일간지의 뉴스 기사를 수집한다면, 정보의 양 자체는 소규모이나, 수작업으로 처리하기는 너무 많은 시간을 소모하게 된다.</p>
<div id="개관" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> 개관</h2>
<p>크롤링은 인터넷 상의 웹을 통해 데이터를 요청하고 응답받는 과정과 확보한 데이터에서 필요한 내용을 추출하는 작업으로 구분할 수 있다.</p>
<p>웹을 통해 데이터를 요청하고 응답받는 작업은 <code>httr</code>패키지를 이용하고, 응답받은 HTML데이터에서 내용을 추출하는 작업은 <code>rvest</code>패키지를 이용한다.
추출한 내용은 <code>tidyverse</code> 등의 패키지를 이용해 전처리하고, <code>tidytext</code> 등의 패키지를 이용해 의미를 추출한다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data2-crawl.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-2"><a href="data2-crawl.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<pre><code>## Loading required package: xml2</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data2-crawl.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## √ ggplot2 3.3.2     √ purrr   0.3.4
## √ tibble  3.0.4     √ dplyr   1.0.2
## √ tidyr   1.1.2     √ stringr 1.4.0
## √ readr   1.4.0     √ forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter()         masks stats::filter()
## x readr::guess_encoding() masks rvest::guess_encoding()
## x dplyr::lag()            masks stats::lag()
## x purrr::pluck()          masks rvest::pluck()</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data2-crawl.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span></code></pre></div>
<div id="웹-작동방식" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> 웹 작동방식</h3>
<p>웹은 월드와이드웹(World Wide Web)의 준말이다. ’범세계적인 망’이란 의미다. 인터넷(Internet) 상에서 HTTP(Hypertext Transfer Protocol: 초본문 전송 규약)를 이용해 정보를 주고받는다.</p>
<p>웹에는 클라이언트(client)와 서버(server) 등 두 종류의 주체가 있다. 클라이언트는 의뢰자로서 서버에 정보제공을 요청(request)한다. 서버는 제공자로서 의뢰자의 요청에 대해 응답(response)한다.</p>
<p>클라이언트와 서버가 정보를 요청하고 응답하기 위해서는 서로 일정한 규약을 따라야 한다. HTTP가 웹에서 클라이언트와 서버가 정보를 주고받는 규약이다.</p>
<div id="url" class="section level4" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> URL</h4>
<p>모든 웹서버는 고유의 주소를 갖고 있다. 클라이언트가 웹브라우저에 웹서버의 주소를 입력해 원하는 웹서버(웹사이트)를 찾아 방문한다. 이 주소를 URL(Uniform Resource Location)라고 한다. 네이버의 URL은 <code>https://www.naver.com</code>이고, 구글의 URL은 <code>https://www.google.com</code>이다.</p>
<p>웹서버에는 다양한 문서와 페이지 등의 자원이 저장돼 있다. 이들 자원의 위치에 대한 식별자를 URI(Universal Resource Identifier)라고 한다. 예를 들어, 네이버의 뉴스의 경제섹션에 접근할 수 있는 주소인 <code>https://news.naver.com/main/main.nhn?mode=LSD&amp;mid=shm&amp;sid1=101</code>는 URI다.</p>
<p>개념적으로 URI에 URL이 포함돼 있지만, URI와 URL을 구분하지 않고 사용하기도 한다. 여기서는 URL과 URI를 구분하지 않고 사용한다.</p>
<p>URL에는 웹서버 이름(hostname), 웹페이지의 경로(path), 질의문(Query string) 등 크게 3개 요소로 이뤄져 있다 (Figure @res(fig:url)).</p>
<div class="figure"><span id="fig:url"></span>
<img src="images/url.JPG" alt="웹 주소 요소" width="1855" />
<p class="caption">
Figure 7.1: 웹 주소 요소
</p>
</div>
<p><code>sid</code>파라미티어의 값이 <code>101</code>이다. 경제섹션을 의미한다. 파라미터의 값을 바꿔 클라이언트가 서버에 보내는 질의내용을 바꿀 수 있다. 예를 들어, 네어버뉴스 URL에서 <code>sid=</code>파라미터의 값을 <code>101</code>에서 <code>102</code>로 바꾸면 사회섹션이 된다.</p>
<p>URL에 대한 보다 자세한 내용은 모질라재단의 <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL">What is a URL?</a> 참조.</p>
</div>
</div>
<div id="연습-2" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> 연습</h3>
<p>네이버뉴스에 접속해 ’백신’을 검색어로 2020년 1월 1일부터 2020년 1월 2일에 국한한 뉴스를 검색해보자. 질의문이 포함된 URL이 웹브라우저의 주소창에 뜬다.</p>
<ul>
<li>URL <a href="https://search.naver.com/search.naver?where=news&amp;query=%EB%B0%B1%EC%8B%A0&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2020.01.01&amp;de=2020.01.02&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20200101to20200102%2Ca%3Aall&amp;mynews=0&amp;refresh_start=0&amp;related=0" class="uri">https://search.naver.com/search.naver?where=news&amp;query=%EB%B0%B1%EC%8B%A0&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2020.01.01&amp;de=2020.01.02&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20200101to20200102%2Ca%3Aall&amp;mynews=0&amp;refresh_start=0&amp;related=0</a></li>
</ul>
<p>이 URI를 요소별로 구분해보자.</p>
<ul>
<li><a href="https://search.naver.com" class="uri">https://search.naver.com</a></li>
<li>/search.naver</li>
<li>?where=news</li>
<li>&amp;query=%EB%B0%B1%EC%8B%A0</li>
<li>&amp;sm=tab_opt</li>
<li>&amp;sort=0</li>
<li>&amp;photo=0</li>
<li>&amp;field=0</li>
<li>&amp;reporter_article=</li>
<li>&amp;pd=3</li>
<li>&amp;ds=2020.01.01</li>
<li>&amp;de=2020.01.02</li>
<li>&amp;docid=</li>
<li>&amp;nso=so%3Ar%2Cp%3Afrom20200101to20200102%2Ca%3Aall</li>
<li>&amp;mynews=0</li>
<li>&amp;refresh_start=0</li>
<li>&amp;related=0</li>
</ul>
<p><code>&amp;query=%EB%B0%B1%EC%8B%A0</code>에서 <code>query=</code>는 질의문의 파라미터 이름이고, <code>%EB%B0%B1%EC%8B%A0</code>는 <code>query=</code>의 값이다. 한글 <code>백신</code>에 해당한다. (한글이 URL에 포함될 때 영어와 숫자로 강제변환되는 이유는 인코딩 때문이다. 자세한 내용은 생활코딩 <a href="https://opentutorials.org/course/50/191">escape항목</a> 참조.)</p>
<p>URL에서 이 파라미터의 값을 <code>영화랭킹</code>으로 바꿔주면 <code>영화랭킹</code>으로 검색한 결과를 제시한다.</p>
<p><code>ds=</code>가 시작일, <code>de=</code>가 종료일 파라미터다. <code>nso=</code>도 기간 설정 파라미터다. <code>nso=</code>의 값을 <code>from20200101to20201231</code>로 변경하면 2020년 1월 1일부터 2020년 12월 31일 사이의 기사가 검색된다.</p>
<p>파라미터의 값이 없거나 <code>0</code>인 부분은 값이 지정되지 않은 파라미터다. HTTP요청과정에 없어도 된다.</p>
<p>따라서 아래 요소만 있어도 2020년 1월 1일부터 2020년 1월 2일 사이의 <code>백신</code>을 검색한 결과가 나온다.</p>
<ul>
<li><a href="https://search.naver.com" class="uri">https://search.naver.com</a></li>
<li>/search.naver</li>
<li>?where=news</li>
<li>&amp;query=%EB%B0%B1%EC%8B%A0</li>
<li>&amp;sm=tab_opt</li>
<li>&amp;pd=3</li>
<li>&amp;ds=2020.01.01</li>
<li>&amp;de=2020.01.02</li>
</ul>
<p>이 요소를 다음과 같은 방식으로 URL을 구성하면 검색어와 날짜를 변경해가며 웹서버에 요청할 수 있다. 예를 들어, <code>query_term</code>의 내용을 다른 검색어(예: 오락)로 바꾸면, 네이버뉴스 검색 창에 검색어를 직접 입력하지 않고도 해당 검색어로 찾는 URL을 만들 수 있다.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data2-crawl.html#cb8-1" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&#39;search.naver.com/search.naver&#39;</span></span>
<span id="cb8-2"><a href="data2-crawl.html#cb8-2" aria-hidden="true" tabindex="-1"></a>where <span class="ot">&lt;-</span> <span class="st">&#39;?where=news&#39;</span></span>
<span id="cb8-3"><a href="data2-crawl.html#cb8-3" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&#39;&amp;query=오락&#39;</span></span>
<span id="cb8-4"><a href="data2-crawl.html#cb8-4" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="st">&#39;&amp;ds=2020.01.01&#39;</span></span>
<span id="cb8-5"><a href="data2-crawl.html#cb8-5" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="st">&#39;&amp;de=2020.01.02&#39;</span></span>
<span id="cb8-6"><a href="data2-crawl.html#cb8-6" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">&lt;-</span> <span class="st">&#39;&amp;sm=tab_opt&#39;</span></span>
<span id="cb8-7"><a href="data2-crawl.html#cb8-7" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="st">&#39;&amp;pd=3&#39;</span></span>
<span id="cb8-8"><a href="data2-crawl.html#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="data2-crawl.html#cb8-9" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">str_c</span>(host, where, query, ds, de, sm, pd)</span>
<span id="cb8-10"><a href="data2-crawl.html#cb8-10" aria-hidden="true" tabindex="-1"></a>url</span></code></pre></div>
<pre><code>## [1] &quot;search.naver.com/search.naver?where=news&amp;query=오락&amp;ds=2020.01.01&amp;de=2020.01.02&amp;sm=tab_opt&amp;pd=3&quot;</code></pre>
<p><code>stringr</code>패키지의 <code>str_c()</code>함수는 문자형 값(string)을 결합(combine)한다.</p>
<div id="크롤링-주의사항" class="section level4" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> 크롤링 주의사항</h4>
<p>크롤링을 할때는 불법행위가 되지 않도록 주의한다. 크롤링의 합법성 여부에 대한 논의는 완결되지 않았다. 이제까지의 판결(2021년 3월 기준)에 따르면 공개된 웹사이트에 대한 크롤링은 불법이 아닌 가능성이 크다. 확실하게 말할 수 없는 이유는 미국에서는 공개된 웹사이틔의 크롤링 행위 자체는 합법적이라고 판결이 나왔지만, 한국에서는 크롤링 행위 자체에 대한 합법성에 대한 부분이 명확하게 제시돼 있지 않기 때문이다.</p>
<p>미국 캘리포니아 연방고등법원(9차 순회 법원: the 9th Circuit)은 2019년 크롤링에 대해 기념비적인 판결을 내렸다. 상대를 적시해 명시적으로 크롤링을 하지 말라는 서한(cease-and-desist letter)을 발송했어도, 로그인이 필요없는 공개된 내용이라면 크롤링이 불법이 아니라고 판결했다 (<a href="https://reason.com/volokh/2019/09/09/scraping-a-public-website-doesnt-violate-the-cfaa-ninth-circuit-mostly-holds">관련기사</a>.</p>
<p>위 판결에 따르면, 비공개(즉, 로그인이 필요한) 사이트의 크롤링은 불법이 될수도 있다. 로그인은 서비스제공자의 사용약관을 따른다는 동의를 한것이기 때문에, 사용약관(Terms of service)에서 기계에 의한 크롤링을 금지하고 있다면 크롤링은 불법이 된다. 따라서 로그인을 통한 크롤링은 웹사이트가 제공하는 API를 이용하는 것이 안전하다.</p>
<p>공개된 웹사이트라도 크롤링으로 수집한 데이터를 영업에 무단 사용하면 멍백하게 불법이다. 예를 들어, 취업정보 업체인 사람인HR이 잡코리아의 사이트에서 채용정보를 크롤링해 자사의 웹사이트에 게재한 행위는 불법이다. (<a href="http://news.bizwatch.co.kr/article/mobile/2017/09/27/0023">관련기사</a>)</p>
<p>크롤링 행위자체가 불법은 아니어도 크롤링 행위로 웹사이트에 피해를 주지는 말아야 한다. 짧은 시간에 너무 많은 접속을 하게 되면 웹서버에 피해를 줄수 있기 때문에 적당한 시간적 간격을 두고 접속한다 (예: <code>Sys.sleep()</code> 함수). 개인 수준의 크롤링은 <code>Sys.sleep()</code>를 설정하지 않아도 네이버 같은 서비스에는 피해를 주지 않겠지만, 피해를 주는 공격으로 간주돼 차단 당할 수 있다.</p>
<p>또한 User Agent 정보를 크롤러에 지정해 서버관리지에게 누가 서버에 접근하는지 알도 있도록 하는 것도 필요하다. 차단당할수도 있다.</p>
</div>
</div>
</div>
<div id="http요청과-응답-httr" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> HTTP요청과 응답 <code>httr</code></h2>
<p>클라이언트가 웹서버의 응답을 HTTP(Hypertext Transfer Protocol: 초본문 전송 규약)로 요청(request)할 때 <code>GET</code> <code>POST</code> <code>PUT</code> <code>DELETE</code> 등 4개 방식을 이용한다. 크롤링에는 <code>GET</code>과 <code>POST</code> 두가지 방식이 주로 쓰인다.</p>
<p>GET방식의 요청은 질의문이 URL에 모두 표시된다. 웹브라우저 주소창에 나타난 URL만으로 HTTP요청을 완료한다.</p>
<p>‘가져오다’ ’받다’는 GET의 의미대로 웹브라우저에 보이는 URL로 웹서버에 요청해 데이터를 가져온다. 클라이언트가 웹서버에 데이터를 요청할 때 URL에 질의문(Query string) 등의 요청 정보가 모두 표시된다. 크롤링할 때 웹브라우저의 주소창에 보이는 웹서버의 URL만 이용해 웹서버에 요청할 수 있다.</p>
<p>POST방식은 질의문이 웹브라우저의 주소창에 나타나지 않는다. 질의문 내용이 브라우저 안에 있어, 이를 브라우저가 ’post’해야 HTTP요청이 완료된다.</p>
<p>‘붙이다’ ’게시하다’는 POST의 의미대로 웹서버에 HTTP요청할 때, 브라우저에 보이는 주소에 질의문을 덧붙여 요청한다. 클라이언트가 서버에 데이터를 요청할 때 질의문 등의 요청 정보가 모두 표시되지 않기 때문에 웹브라우저의 주소창에 보이는 웹서버의 URL만으로는 웹서버에 요청 내용을 파악할 수 없다.</p>
<p>POST방식으로 HTTP를 처리하는 웹페이지를 크롤링하기 위해서는 사용자가 브라우저의 개발자도구에서 요청에 필요한 질의정보를 찾아 요청해야 한다(추후 상세한 설명).</p>
<p>R로 크롤링할 때는 <code>httr</code>패키지에서 제공하는 <code>GET()</code>과 <code>POST()</code>할수를 이용한다. <code>httr</code>패키지는 <code>tidyverse</code>패키지에 포함돼 설치되나 <code>tidyverse</code> 탑재시 함께 부착되지 않기 때문에 별도로 <code>library()</code>함수로 R환경에 탑재한다.</p>
<div id="get-방식" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> GET 방식</h3>
<p><code>httr</code>패키지의 <code>GET()</code>함수를 이용한다. 위키백과의 HTML항목을 <code>GET()</code>함수로 받아보자.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data2-crawl.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb10-2"><a href="data2-crawl.html#cb10-2" aria-hidden="true" tabindex="-1"></a>wiki_url <span class="ot">&lt;-</span> <span class="st">&#39;https://ko.wikipedia.org/wiki/HTML&#39;</span></span>
<span id="cb10-3"><a href="data2-crawl.html#cb10-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">GET</span>(wiki_url)</span>
<span id="cb10-4"><a href="data2-crawl.html#cb10-4" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<p>웹페이지(여기서는 위키백과 HTML항목)의 응답(Response)받은 객체에 응답에 대한 메타데이터가 들어 있다. 상태코드(status)는 200, 인코딩(charset)은 UTF-8이다.</p>
<p>상태코드는 클라이언트의 요청에 대한 웹서버의 응답상태다. 각 코드의 의미는 다음과 같다.</p>
<ul>
<li><p>1xx 조건부 응답. 요청을 받고 처리중.</p></li>
<li><p>2xx 성공. 요청을 정상적으로 처리.</p></li>
<li><p>3xx 재전송. 요청완료를 위해 추가 동작.</p></li>
<li><p>4xx 클라이언트 오류. 처리불능인 요청(권한 없음, 주소 없음 등)</p></li>
<li><p>5xx 서버 오류. 서버가 요청처리를 못해 불능(서버 다운 등)</p></li>
</ul>
<p>자세한 내용은 위키백과 <a href="https://ko.wikipedia.org/wiki/HTTP_%EC%83%81%ED%83%9C_%EC%BD%94%EB%93%9C">HTTP 상태코드</a> 참조.</p>
<div id="연습-3" class="section level4" number="7.2.1.1">
<h4><span class="header-section-number">7.2.1.1</span> 연습</h4>
<p>네이버뉴스에 접속해 ’인공지능’을 검색어로 2021년 1월 1일부터 2021년 1월 31일에 국한한 뉴스를 검색해 URL을 확보한 다음, URL을 요소별로 분해한 다음, 이를 <code>str_c()</code>함수로 다시 URL을 완성하고, 이 URL을 이용해 GET방식으로 요청한 다음, 서버의 응답 상태코드(status)결과를 제시하시오.</p>
<ul>
<li>URL 확보</li>
</ul>
<p><a href="https://search.naver.com/search.naver?where=news&amp;query=%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.01.01&amp;de=2021.01.31&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210101to20210131%2Ca%3Aall&amp;mynews=0&amp;refresh_start=0&amp;related=0" class="uri">https://search.naver.com/search.naver?where=news&amp;query=%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.01.01&amp;de=2021.01.31&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210101to20210131%2Ca%3Aall&amp;mynews=0&amp;refresh_start=0&amp;related=0</a></p>
<p>URL에서 프로토콜 부분(<a href="https://)을" class="uri">https://)을</a> 제외하고 복사하면 한글 검색어가 그대로 유지된다.</p>
<p>search.naver.com/search.naver?where=news&amp;query=인공지능&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.01.01&amp;de=2021.01.31&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210101to20210131%2Ca%3Aall&amp;mynews=0&amp;refresh_start=0&amp;related=0</p>
<ul>
<li><p>요소별 분해
search.naver.com/search.naver?where=news
&amp;query=인공지능
&amp;sm=tab_opt
&amp;sort=0
&amp;photo=0
&amp;field=0
&amp;reporter_article=
&amp;pd=3
&amp;ds=2021.01.01
&amp;de=2021.01.31
&amp;docid=
&amp;nso=so%3Ar%2Cp%3Afrom20210101to20210131%2Ca%3Aall
&amp;mynews=0
&amp;refresh_start=0
&amp;related=0</p></li>
<li><p>URL 결합</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data2-crawl.html#cb11-1" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&#39;search.naver.com/search.naver&#39;</span></span>
<span id="cb11-2"><a href="data2-crawl.html#cb11-2" aria-hidden="true" tabindex="-1"></a>where <span class="ot">&lt;-</span> <span class="st">&#39;?where=news&#39;</span></span>
<span id="cb11-3"><a href="data2-crawl.html#cb11-3" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&#39;&amp;query=인공지능&#39;</span></span>
<span id="cb11-4"><a href="data2-crawl.html#cb11-4" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="st">&#39;&amp;ds=2021.01.01&#39;</span></span>
<span id="cb11-5"><a href="data2-crawl.html#cb11-5" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="st">&#39;&amp;de=2021.01.31&#39;</span></span>
<span id="cb11-6"><a href="data2-crawl.html#cb11-6" aria-hidden="true" tabindex="-1"></a>sm <span class="ot">&lt;-</span> <span class="st">&#39;&amp;sm=tab_opt&#39;</span></span>
<span id="cb11-7"><a href="data2-crawl.html#cb11-7" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="st">&#39;&amp;pd=3&#39;</span></span>
<span id="cb11-8"><a href="data2-crawl.html#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="data2-crawl.html#cb11-9" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">str_c</span>(host, where, query, ds, de, sm, pd)</span>
<span id="cb11-10"><a href="data2-crawl.html#cb11-10" aria-hidden="true" tabindex="-1"></a>url</span></code></pre></div>
<pre><code>## [1] &quot;search.naver.com/search.naver?where=news&amp;query=인공지능&amp;ds=2021.01.01&amp;de=2021.01.31&amp;sm=tab_opt&amp;pd=3&quot;</code></pre>
<ul>
<li>요청</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data2-crawl.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">GET</span>(url)</span></code></pre></div>
<pre><code>## Warning in strsplit(rawToChar(raw), &quot;\r?\n&quot;): 이 로케일에서는 입력문자열 1는 유
## 효하지 않습니다</code></pre>
<pre><code>## Response [https://search.naver.com/search.naver?where=news&amp;query=인공지능&amp;ds=2021.01.01&amp;de=2021.01.31&amp;sm=tab_opt&amp;pd=3]
##   Date: 2021-03-25 01:09
##   Status: 200
##   Content-Type: &lt;unknown&gt;
##   Size: 746 kB
## &lt;BINARY BODY&gt;</code></pre>
<p>상태코드(Status) 200. 성공.</p>
</div>
</div>
<div id="post방식" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> POST방식</h3>
<p>GET방식에서는 URL에서 질의 내용이 모두 포함돼 있지만, POST방식에서는 URL에 질의 내용이 들어 있지 않다. 질의 정보가 브라우저 안에 있다.</p>
<p>먼저, 한국학술지인용색인에서 <a href="https://www.kci.go.kr/">한국학술지인용색인</a>에 접속해 ’백신`으로 검색해, 브라우저의 주소창에 나타난 URL를 확인해 보자.</p>
<ul>
<li>URL <a href="https://www.kci.go.kr/kciportal/po/search/poTotalSearList.kci" class="uri">https://www.kci.go.kr/kciportal/po/search/poTotalSearList.kci</a></li>
</ul>
<p>GET방식의 주소와 달리, 질의 정보가 없다. POST방식에서 질의 정보는 브라우저의 개발자정보를 열어 확보할수 있다. 개발자도구(브라우저 F12 키)를 열면[네트워크]항목이 뜬다(Figure: <a href="data2-crawl.html#fig:f12">7.2</a>). (마우스 오른쪽 버튼 -&gt; [검사(Inspection)] -&gt; [Network] -&gt; [Doc]).</p>
<div class="figure"><span id="fig:f12"></span>
<img src="images/f12.png" alt="개발자도구 화면" width="1824" />
<p class="caption">
Figure 7.2: 개발자도구 화면
</p>
</div>
<p>개발자도구가 뜨면 브라우저를 재장전(reload: Ctrl+R)한다. 하단 왼쪽에 URL의 경로정보가 뜬다 (Figure: <a href="data2-crawl.html#fig:f12-path">7.3</a>).</p>
<div class="figure"><span id="fig:f12-path"></span>
<img src="images/f12-path.png" alt="개발자도구 화면: 경로" width="1867" />
<p class="caption">
Figure 7.3: 개발자도구 화면: 경로
</p>
</div>
<p>개발자정보 화면의 경로정보를 클릭하면 오른쪽에 브라우저의 요청청보와 서버의 응답정보가 나타난다. 스크롤다운하면 [Form Data] 항목에 브라우저의 질의 정보가 있다. 브라우저의 왼쪽 상단에 있는 [검색결과] 옵션에서 주제를 ’사회과학’을 선택해 [선택항복 재검색]을 클릭해 보자. 질의정보가 갱신된다 (Figure: <a href="data2-crawl.html#fig:f12-query">7.4</a>).</p>
<div class="figure"><span id="fig:f12-query"></span>
<img src="images/f12-query.JPG" alt="개발자도구 화면: 질의정보" width="2210" />
<p class="caption">
Figure 7.4: 개발자도구 화면: 질의정보
</p>
</div>
<p>[Form Data]에 있는 질의정보를 그대로 <code>httr</code>패키지의 <code>POST()</code>함수에 투입하면 서버에 요청정보를 만들 수 있다. <code>POST()</code>함수의 <code>body =</code>인자에 list로 만들어 준다.</p>
<p><code>POST()</code>함수로 요청할 때 문자가 깨지는 경우가 있으므로, 시스템 로케일을 <code>Sys.setlocale()</code>함수을 이용해 영문으로 설정한 다음, 다시 국문으로 바꿔준다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data2-crawl.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb16-2"><a href="data2-crawl.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="data2-crawl.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;English&quot;</span>)</span>
<span id="cb16-4"><a href="data2-crawl.html#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="data2-crawl.html#cb16-5" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&#39;https://www.kci.go.kr/kciportal/po/search/poTotalSearList.kci&#39;</span></span>
<span id="cb16-6"><a href="data2-crawl.html#cb16-6" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">POST</span>(</span>
<span id="cb16-7"><a href="data2-crawl.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  host,</span>
<span id="cb16-8"><a href="data2-crawl.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">body =</span></span>
<span id="cb16-9"><a href="data2-crawl.html#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb16-10"><a href="data2-crawl.html#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.printKeyword =</span> <span class="st">&#39;백신&#39;</span>,</span>
<span id="cb16-11"><a href="data2-crawl.html#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.sortName =</span> <span class="st">&#39;SCORE&#39;</span>,</span>
<span id="cb16-12"><a href="data2-crawl.html#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.sortDir =</span> <span class="st">&#39;desc&#39;</span>,</span>
<span id="cb16-13"><a href="data2-crawl.html#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.docsCount =</span> <span class="dv">10</span>,</span>
<span id="cb16-14"><a href="data2-crawl.html#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.startPg =</span> <span class="dv">1</span>,</span>
<span id="cb16-15"><a href="data2-crawl.html#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">reSrchCondition =</span> <span class="st">&#39;all&#39;</span>,</span>
<span id="cb16-16"><a href="data2-crawl.html#cb16-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">reSrchKeyword =</span> <span class="st">&#39;백신&#39;</span>,</span>
<span id="cb16-17"><a href="data2-crawl.html#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="st">&#39;searchFromTotal&#39;</span></span>
<span id="cb16-18"><a href="data2-crawl.html#cb16-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-19"><a href="data2-crawl.html#cb16-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-20"><a href="data2-crawl.html#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="data2-crawl.html#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;Korean&quot;</span>)</span></code></pre></div>
<p>상태코드(Status)가 <code>200</code>으로 요청과 응답상태가 성공이다.</p>
</div>
</div>
<div id="텍스트-추출-rvest" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> 텍스트 추출 <code>rvest</code></h2>
<p><code>GET()</code>과 <code>POST()</code>함수로 받은 파일에는 다양한 응답정보가 들어있다. <code>glimpse()</code>함수로 앞서 <code>POST()</code>함수로 받은 한국학술지인용색인에서 ’백신’으로 검색한 내용을 확인해 보자.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data2-crawl.html#cb17-1" aria-hidden="true" tabindex="-1"></a>url <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>##  chr &quot;search.naver.com/search.naver?where=news&amp;query=인공지능&amp;ds=2021.01.01&amp;de=2021.01.31&amp;sm=tab_opt&amp;pd=3&quot;</code></pre>
<p>URL, 상태코드, 질의정보 등 다양한 내용이 들어 있다. 이 파일에서 분석에 필요한 텍스트를 추출하기 위해서는 <code>rvest</code>패키지의 함수를 이용한다.</p>
<p><code>rvest</code>패키지의 함수는 3종류로 구분할 수 있다.</p>
<ul>
<li>HTML문서 불러오기
<ul>
<li><code>read_html()</code></li>
</ul></li>
<li>HTML문서에서 HTML요소 추출
<ul>
<li><code>html_node()</code> <code>html_nodes()</code></li>
</ul></li>
<li>HTML요소에서 내용 혹은 속성의 값 추출
<ul>
<li><code>html_text()</code> <code>html_table()</code> <code>html_attr()</code> <code>html_attrs()</code></li>
</ul></li>
</ul>
<div id="html문서-불러오기" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> HTML문서 불러오기</h3>
<div id="read_html" class="section level4" number="7.3.1.1">
<h4><span class="header-section-number">7.3.1.1</span> <code>read_html()</code></h4>
<p>웹서버에서 HTML파일을 다운로드 받았으면 <code>read_html()</code>함수를 이용해 HTML문서로 불러오기를 한다.</p>
<p>위키백과의 <a href="https://ko.wikipedia.org/wiki/HTML">HTML항목</a>(Figure <a href="data2-crawl.html#fig:wikihtml">7.5</a>)을 <code>read_html()</code>함수를 이용해 HTML문서를 불러오기 해보자.</p>
<div class="figure"><span id="fig:wikihtml"></span>
<img src="images/htmlwiki.JPG" alt="위키백과 HTML항목" width="2426" />
<p class="caption">
Figure 7.5: 위키백과 HTML항목
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data2-crawl.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb19-2"><a href="data2-crawl.html#cb19-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">&#39;https://ko.wikipedia.org/wiki/HTML&#39;</span>)</span>
<span id="cb19-3"><a href="data2-crawl.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) </span></code></pre></div>
<pre><code>## {html_document}
## &lt;html class=&quot;client-nojs&quot; lang=&quot;ko&quot; dir=&quot;ltr&quot;&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8 ...
## [2] &lt;body class=&quot;mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject  ...</code></pre>
<p>여러 HTML 요소(element)가 포함된 문서가 산출된다. <code>&lt;head&gt;</code>와 <code>&lt;body&gt;</code> 등의 태그(tag)가 보인다. 이처럼 HTML문서는 태그(tag)로 문서의 내용이 마크업돼 있다.</p>
</div>
</div>
<div id="html요소-추출" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> HTML요소 추출</h3>
<p>불러오기를 한 HTML문서에서 필요한 HTML요소(element)를 추출한다.</p>
<div id="html_node-html_nodes" class="section level4" number="7.3.2.1">
<h4><span class="header-section-number">7.3.2.1</span> <code>html_node()</code> <code>html_nodes()</code></h4>
<p>HTML코드는 여러 HTML요소(element)로 이뤄져 있는데, 이 요소들을 추출하는 함수가 <code>html_node()</code>와 <code>html_nodes()</code>다.</p>
<ul>
<li><p><code>html_node()</code> 일치하는 요소 하나 만을 추출.</p></li>
<li><p><code>html_nodes()</code> 공통적으로 적용되는 여러 요소 추출</p></li>
</ul>
<p><code>html_node()</code>함수를 이용해 원하는 요소만을 추출할 수 있다. 먼저 <code>&lt;head&gt;</code>요소만 추출해보자.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data2-crawl.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="data2-crawl.html#cb21-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_node</span>(<span class="st">&#39;head&#39;</span>)</span></code></pre></div>
<pre><code>## {html_node}
## &lt;head&gt;
##  [1] &lt;meta charset=&quot;UTF-8&quot;&gt;\n
##  [2] &lt;title&gt;HTML - 위키백과, 우리 모두의 백과사전&lt;/title&gt;\n
##  [3] &lt;script&gt;document.documentElement.className=&quot;client-js&quot;;RLCONF={&quot;wgBreakF ...
##  [4] &lt;script&gt;(RLQ=window.RLQ||[]).push(function(){mw.loader.implement(&quot;user.o ...
##  [5] &lt;link rel=&quot;stylesheet&quot; href=&quot;/w/load.php?lang=ko&amp;amp;modules=ext.cite.st ...
##  [6] &lt;script async=&quot;&quot; src=&quot;/w/load.php?lang=ko&amp;amp;modules=startup&amp;amp;only=s ...
##  [7] &lt;meta name=&quot;ResourceLoaderDynamicStyles&quot; content=&quot;&quot;&gt;\n
##  [8] &lt;link rel=&quot;stylesheet&quot; href=&quot;/w/load.php?lang=ko&amp;amp;modules=site.styles ...
##  [9] &lt;meta name=&quot;generator&quot; content=&quot;MediaWiki 1.36.0-wmf.35&quot;&gt;\n
## [10] &lt;meta name=&quot;referrer&quot; content=&quot;origin&quot;&gt;\n
## [11] &lt;meta name=&quot;referrer&quot; content=&quot;origin-when-crossorigin&quot;&gt;\n
## [12] &lt;meta name=&quot;referrer&quot; content=&quot;origin-when-cross-origin&quot;&gt;\n
## [13] &lt;meta property=&quot;og:image&quot; content=&quot;https://upload.wikimedia.org/wikipedi ...
## [14] &lt;meta property=&quot;og:title&quot; content=&quot;HTML - 위키백과, 우리 모두의 백과사전&quot;&gt;\n
## [15] &lt;meta property=&quot;og:type&quot; content=&quot;website&quot;&gt;\n
## [16] &lt;link rel=&quot;preconnect&quot; href=&quot;//upload.wikimedia.org&quot;&gt;\n
## [17] &lt;link rel=&quot;alternate&quot; media=&quot;only screen and (max-width: 720px)&quot; href=&quot;/ ...
## [18] &lt;link rel=&quot;alternate&quot; type=&quot;application/x-wiki&quot; title=&quot;편집&quot; href=&quot;/w/inde ...
## [19] &lt;link rel=&quot;edit&quot; title=&quot;편집&quot; href=&quot;/w/index.php?title=HTML&amp;amp;action=edi ...
## [20] &lt;link rel=&quot;apple-touch-icon&quot; href=&quot;/static/apple-touch/wikipedia.png&quot;&gt;\n
## ...</code></pre>
<p>HTML문서의 <code>&lt;head&gt;</code>섹션에 있는 HTML요소들을 추출했다. HTML문서는 메타데이터가 들어 있는 <code>&lt;head&gt;</code>섹션과 사용자에게 보여지는 내용이 들어 있는 <code>&lt;body&gt;</code>섹션으로 이뤄져 잇다.</p>
<p><code>&lt;body&gt;</code>섹션 안의 HTML요소들을 추출해보자.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data2-crawl.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="data2-crawl.html#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_node</span>(<span class="st">&#39;body&#39;</span>)</span></code></pre></div>
<pre><code>## {html_node}
## &lt;body class=&quot;mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-HTML rootpage-HTML skin-vector action-view skin-vector-search-vue&quot;&gt;
## [1] &lt;div class=&quot;mw-page-container&quot;&gt;\n\t&lt;a class=&quot;mw-jump-link&quot; href=&quot;#content ...
## [2] &lt;script&gt;(RLQ=window.RLQ||[]).push(function(){mw.config.set({&quot;wgPageParseR ...
## [3] &lt;script type=&quot;application/ld+json&quot;&gt;{&quot;@context&quot;:&quot;https:\\/\\/schema.org&quot;,&quot; ...
## [4] &lt;script&gt;(RLQ=window.RLQ||[]).push(function(){mw.config.set({&quot;wgBackendRes ...</code></pre>
<p>이번에는 <code>&lt;div&gt;</code>와 <code>&lt;script&gt;</code> 등 새로운 태그가 보인다.</p>
<ul>
<li><p><code>&lt;div&gt;</code> 웹페이지의 division(구획) 지정.</p></li>
<li><p><code>&lt;script&gt;</code> 자바스크립트로 웹페이지의 구동방식 지정.</p></li>
</ul>
<p><code>&lt;div&gt;</code> 구획 안의 HTML요소들을 추출해보자.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data2-crawl.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="data2-crawl.html#cb25-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_node</span>(<span class="st">&#39;div&#39;</span>)</span></code></pre></div>
<pre><code>## {html_node}
## &lt;div class=&quot;mw-page-container&quot;&gt;
## [1] &lt;a class=&quot;mw-jump-link&quot; href=&quot;#content&quot;&gt;내용으로 건너뛰기&lt;/a&gt;
## [2] &lt;div class=&quot;mw-page-container-inner&quot;&gt;\n\n&lt;input type=&quot;checkbox&quot; id=&quot;mw-si ...</code></pre>
<p><code>html_node()</code>함수는 일치하는 요소 단 하나만 추출하는 반면, <code>html_nodes()</code>는 공통적으로 일치하는 복수의 요소를 추출한다.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data2-crawl.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="data2-crawl.html#cb27-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;div&#39;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (149)}
##  [1] &lt;div class=&quot;mw-page-container&quot;&gt;\n\t&lt;a class=&quot;mw-jump-link&quot; href=&quot;#conten ...
##  [2] &lt;div class=&quot;mw-page-container-inner&quot;&gt;\n\n&lt;input type=&quot;checkbox&quot; id=&quot;mw-s ...
##  [3] &lt;div id=&quot;p-search&quot; role=&quot;search&quot; class=&quot;p-search--show-thumbnail&quot;&gt;\n\t&lt;h ...
##  [4] &lt;div id=&quot;simpleSearch&quot; data-search-loc=&quot;header-moved&quot;&gt;\n\t\t\t&lt;input typ ...
##  [5] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [6] &lt;div class=&quot;mw-workspace-container&quot;&gt;\n\t&lt;div id=&quot;mw-navigation&quot;&gt;\n\t\t&lt;h ...
##  [7] &lt;div id=&quot;mw-navigation&quot;&gt;\n\t\t&lt;h2&gt;둘러보기 메뉴&lt;/h2&gt;\n\t\t\n&lt;div id=&quot;mw-panel&quot; ...
##  [8] &lt;div id=&quot;mw-panel&quot; class=&quot;mw-sidebar&quot;&gt;\n\t&lt;!-- Please do not use role at ...
##  [9] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [10] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [11] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [12] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [13] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [14] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [15] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [16] &lt;div class=&quot;after-portlet after-portlet-lang&quot;&gt;&lt;span class=&quot;wb-langlinks- ...
## [17] &lt;div id=&quot;mw-head&quot;&gt;\n\t\t\t&lt;div class=&quot;mw-article-toolbar-container&quot;&gt;\n\t ...
## [18] &lt;div class=&quot;mw-article-toolbar-container&quot;&gt;\n\t\t\t\t&lt;div id=&quot;left-naviga ...
## [19] &lt;div id=&quot;left-navigation&quot;&gt;\n\t\t\t\t\t&lt;!-- Please do not use role attrib ...
## [20] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## ...</code></pre>
</div>
<div id="html-요소element의-종류" class="section level4" number="7.3.2.2">
<h4><span class="header-section-number">7.3.2.2</span> HTML 요소(element)의 종류</h4>
<p>HTML 요소(element)는 태그(tag), 속성(attribute), 속성의 값(value), 내용 등으로 구성된다(Figure <a href="data2-crawl.html#fig:htmlelement">7.6</a>).</p>
<div class="figure"><span id="fig:htmlelement"></span>
<img src="images/htmlelement.JPG" alt="HTML 요소" width="1024" />
<p class="caption">
Figure 7.6: HTML 요소
</p>
</div>
<p>HTML의 구조와 내용을 정하는 주요 태그는 다음과 같다.</p>
<ul>
<li><p><code>head</code> HTML의 헤더(header). 메타데이터를 담고 있다.</p></li>
<li><p><code>body</code> HTML의 본문(body). 사용자에게 보여지는 부분.</p></li>
<li><p><code>h</code> ~ <code>h6</code> 제목(headline) 설정. 숫자가 클수록 크게 표시.</p></li>
<li><p><code>p</code> 단락(paragraph) 구분.</p></li>
<li><p><code>div</code> 구획(division)</p></li>
<li><p><code>br</code> 공백(<code>&lt;br&gt;</code>태그는 종료 태그가 없다.)</p></li>
</ul>
<p>아래 태그는 속성(attribute)과 함께 사용하는 태그다.</p>
<ul>
<li><p><code>a</code> 하이퍼링크 정의. URL을 지정하는 <code>href</code>속성과 함께 사용.</p></li>
<li><p><code>img</code> 이미지 정의. 이미지파일을 지정하는 <code>src</code>속성과 함께 사용.</p></li>
<li><p><code>span</code> 본문 안에서 특정 부분 지정. <code>style</code>속성과 함께 사용.</p></li>
</ul>
<p>아래 태그는 목록과 표 구성에 사용하는 태그다.</p>
<ul>
<li><p><code>ol</code> <code>ul</code> 목록(list) 지정. <code>ol</code>은 순서목록(ordered list), <code>ul</code>은 순서없는 목록(unordered list)</p>
<ul>
<li><code>li</code> 목록 안의 아이템 <code>li</code>태그는 <code>ol</code>나 <code>ul</code>태그 안에서 함께 사용.</li>
</ul></li>
<li><p><code>table</code> 표(table) 지정</p>
<ul>
<li><p><code>tr</code> 표의 각 행(row) 지정</p></li>
<li><p><code>th</code> 표의 행이름(header) 지정</p></li>
<li><p><code>td</code> 표의 각 행에 들어가는 데이터(data)</p></li>
</ul></li>
</ul>
<p>HTML코드가 어떻게 작동하는지 w3school.com에서 제공하는 편집기로 연습해 보자.</p>
<ul>
<li><a href="https://www.w3schools.com/tags/tryit.asp?filename=tryhtml_div_test">w3school 편집기</a></li>
</ul>
</div>
<div id="css-selector" class="section level4" number="7.3.2.3">
<h4><span class="header-section-number">7.3.2.3</span> CSS selector</h4>
<p>HTML태그는 <code>style</code>속성과 함께 사용해 웹페이지의 표현방식(style)을 지정한다. <code>style</code>속성은 단일 HTML요소의 표현 양식만을 지정하므로, 여러 HTML요소에 공통적으로 표현양식을 지정하기 위해서는 CSS(Cascading Style Sheet)을 사용한다.</p>
<ul>
<li><p>HTLM: 웹페이지의 구조와 내용 정의</p></li>
<li><p>CSS: 웹페이지의 표현 방식 지정</p></li>
</ul>
<p>CSS selector는 웹페이지 하부요소의 표현양식을 지정하는데 쓰이나, HTML문서에서 특정 요소를 찾아 추출하는데 유용하다. CSS selector에서 일련의 태그에 공통적으로 지정하는 속성의 이름이 class(클래스)다. 태그 다음에 <code>.</code>를 이용해 표기한다. 예를 들어, <code>div</code>태그에서 클래스의 값을 <code>myDiv</code>라고 지정한 경우, <code>div.myDiv</code>가 된다. 이 경우, 웹페이지 소스(Figure <a href="data2-crawl.html#fig:pgsrc">7.8</a>)에서 <code>div.myDiv</code>를 찾으면, <code>div</code>태그 속성의 값이 <code>myDiv</code>인 모든 HTML요소를 찾을 수 있다.</p>
<p>CSS에서 특정 HTML요소의 표현양식만 지정할 때 사용하는 속성의 이름은 ID다. 특정 <code>div</code>태그의 HTML요소만 별도의 표현양식을 지정하려면, 속성의 이름을 ID로 지정한다. 속성명을 ID로 지정하면 <code>#</code>으로 구분한다. 예를 들어, ID의 값을 <code>thisDiv</code>라고 지정한 경우, <code>#thisDiv</code>로 표기한다. ID는 해당 웹페이지에 유일하므로, 태그명을 지정하지 않는다. 따라서 웹페이지 소스에서 <code>#thisDiv</code>를 찾으면, <code>div</code>태그 속성의 값이 <code>thisDiv</code>인 HTML요소를 찾을 수 있다.</p>
<p>앞서 제시한 위키백과의 HTLM항목에서 <code>div</code>태그에서 속성의 이름이 <code>class</code>이고 그 속성의 값이 <code>vector-menu-content</code>인 HTML요소를 추출해보자. 여러 HTML요소에 적용되므로 <code>html_nodes()</code>함수를 이용한다.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data2-crawl.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="data2-crawl.html#cb29-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;div.vector-menu-content&#39;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (12)}
##  [1] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [2] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [3] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [4] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [5] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [6] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [7] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [8] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
##  [9] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [10] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [11] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...
## [12] &lt;div class=&quot;vector-menu-content&quot;&gt;\n\t\t&lt;ul class=&quot;vector-menu-content-li ...</code></pre>
<div id="웹페이지-소스" class="section level5" number="7.3.2.3.1">
<h5><span class="header-section-number">7.3.2.3.1</span> 웹페이지 소스</h5>
<p>HTML문서에서 원하는 요소를 어떻게 찾을 수 있을까? 브라우저에서 지원하는 개발자 도구를 이용한다. <code>F12</code>키를 누르면 나타난다. 또는 마우스 오른쪽 버튼을 이용할수도 있다. 브라우저(여기서는 크롬 기준)에 나타난 본문 위에 마우스 커서를 이동하여, 마우스 오른쪽 버튼을 클릭하면 메뉴 창이 열리는데 하단에 ‘검사(inspect)’ 항목이 있다(Figure <a href="data2-crawl.html#fig:inspect">7.7</a>). 이곳을 클릭해보자.</p>
<div class="figure"><span id="fig:inspect"></span>
<img src="images/wikihtml_inspect.JPG" alt="웹피이지 소스 화면 진입" width="874" />
<p class="caption">
Figure 7.7: 웹피이지 소스 화면 진입
</p>
</div>
<p>오른쪽 창에 해당 웹페이지의 HTML코드가 나온다. 오른쪽 HTML 코드 창에서 마우스 커서를 호버링해보자. HTML코드에 해당하는 부분이 왼쪽 웹페이지에서 표시된다(Figure <a href="data2-crawl.html#fig:pgsrc">7.8</a>). 아래 제시된 화면은 <code>&lt;p&gt;</code>와 <code>&lt;/p&gt;</code>태그 사이의 내용이 선택돼 있다.</p>
<p>이 상태에서 오른쪽 HTML 코드창에서 선택한 HTML코드 위에 마우스 커서를 놓고, 마우스 오른쪽 버튼을 클릭하면 메뉴가 뜨는데, 이곳에서 ’copy’를 선택하면 다시 메뉴가 뜬다. ’Copy selector`를 선택하자. 해당 노드를 지정하는 요소가 복사된다.
(브라우저마다 용어가 다르다. 파이어폭스는 ’CSS selector’이고, 사파리는 ’Selector Path’다)</p>
<div class="figure"><span id="fig:pgsrc"></span>
<img src="images/wikihtml_inspect_p.JPG" alt="웹페이지 소스 화면" width="1704" />
<p class="caption">
Figure 7.8: 웹페이지 소스 화면
</p>
</div>
<p>R스튜디오의 편집창으로 와서, 복사한 내용을 붙여넣는다.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data2-crawl.html#cb31-1" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; p:nth-child(4)&#39;</span></span></code></pre></div>
<ul>
<li><p><code>#mw-content-text</code> HTML코드에서 <code>#</code>은 CSS selector에서 ID를 의미한다. ID는 클래스와 마찬가지로 CSS로 웹페이지 표현양식을 지정하지만, 클래스와 달리 특정 HTML요소만 꾸밀 때 사용한다. 여기서는 ID 값이 <code>mw-content-text</code>인 HTML 요소를 나타낸다.</p></li>
<li><p><code>div.mw-parser-output</code> HTML코드에서 태그 이름과 클래스 속성의 값을 <code>.</code>로 구분한다. 여기서 <code>div.mw-parser-output</code>는 <code>div</code>태그를 꾸미는 CSS 클래스가 <code>.mw-parser-output</code>란 의미이므로, <code>div</code>태그 속성의 값이 <code>.mw-parser-output</code>인 모든 요소를 나타낸다.</p></li>
<li><p><code>&gt;</code>는 서열구조를 나타낸다. 따라서 여기서는 ID 값이 <code>mw-content-text</code>인 HTML요소 중 <code>div</code>태그 속성의 값이 <code>.mw-parser-output</code>인 모든 요소를 나타난대.</p></li>
<li><p><code>p:nth-child(4)</code> HTML코드에서 <code>:nth-child(숫자)</code>는 HTML요소 안의 하부 요소를 지정할 때 사용한다. 여기서는 <code>&lt;p&gt;</code>태그 안의 4번째 하부 요소란 의미다.</p></li>
</ul>
<p>이제 <code>html_node()</code>함수로 해당 노드의 내용을 추출하자.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data2-crawl.html#cb32-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://ko.wikipedia.org/wiki/HTML&#39;</span></span>
<span id="cb32-2"><a href="data2-crawl.html#cb32-2" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; p:nth-child(4)&#39;</span></span>
<span id="cb32-3"><a href="data2-crawl.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="data2-crawl.html#cb32-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_node</span>(<span class="at">css =</span> text_css)</span></code></pre></div>
<pre><code>## {html_node}
## &lt;p&gt;
##  [1] &lt;b&gt;하이퍼텍스트 마크업 언어&lt;/b&gt;
##  [2] &lt;span lang=&quot;en&quot;&gt;HyperText Markup Language, &lt;b&gt;HTML&lt;/b&gt;&lt;/span&gt;
##  [3] &lt;span style=&quot;font-size: smaller;&quot;&gt;&lt;a href=&quot;/wiki/%EB%AC%B8%ED%99%94%EC%9 ...
##  [4] &lt;a href=&quot;/wiki/%EC%9B%B9_%ED%8E%98%EC%9D%B4%EC%A7%80&quot; title=&quot;웹 페이지&quot;&gt;웹 페이 ...
##  [5] &lt;a href=&quot;/wiki/%EB%A7%88%ED%81%AC%EC%97%85_%EC%96%B8%EC%96%B4&quot; title=&quot;마크 ...
##  [6] &lt;a href=&quot;/wiki/%EA%B5%AC%EC%A1%B0%EC%A0%81_%EB%AC%B8%EC%84%9C&quot; title=&quot;구조 ...
##  [7] &lt;a href=&quot;/wiki/%EA%B4%84%ED%98%B8#%EA%BA%BE%EC%87%A0_%EA%B4%84%ED%98%B8&quot; ...
##  [8] &lt;a href=&quot;/wiki/HTML_%EC%9A%94%EC%86%8C&quot; title=&quot;HTML 요소&quot;&gt;HTML 요소&lt;/a&gt;
##  [9] &lt;a href=&quot;/wiki/%EC%9B%B9_%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80&quot; title=&quot;웹  ...
## [10] &lt;a href=&quot;/wiki/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8&quot; t ...
## [11] &lt;a href=&quot;/wiki/CSS&quot; title=&quot;CSS&quot;&gt;CSS&lt;/a&gt;
## [12] &lt;a href=&quot;/wiki/%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8_%EC%96%B8%EC%96%B4&quot;  ...
## [13] &lt;a href=&quot;/wiki/W3C&quot; title=&quot;W3C&quot;&gt;W3C&lt;/a&gt;
## [14] &lt;sup id=&quot;cite_ref-deprecated_1-0&quot; class=&quot;reference&quot;&gt;&lt;a href=&quot;#cite_note- ...</code></pre>
<p>여전히 HTML태그가 많다. HTML요소에서 데이터 혹은 속성을 추출할 필요가 있다.</p>
</div>
</div>
</div>
<div id="html요소에서-내용-추출" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> HTML요소에서 내용 추출</h3>
<p>추출한 HTML요소에서 관련 내용, 속성의 내용, 테이블 등을 추출한다.</p>
<ul>
<li><p>텍스트 내용 추출 <code>html_text()</code></p></li>
<li><p>속성의 내용 추출 <code>html_attr()</code> <code>html_attrs()</code></p></li>
<li><p>테이블 내용 추출 <code>htmal_table()</code></p></li>
</ul>
<div id="html_text" class="section level4" number="7.3.3.1">
<h4><span class="header-section-number">7.3.3.1</span> <code>html_text()</code></h4>
<p>HTML요소에서 본문 텍스트만 추출하기 위해서는 <code>html_text()</code>함수를 이용한다.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data2-crawl.html#cb34-1" aria-hidden="true" tabindex="-1"></a>html_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="data2-crawl.html#cb34-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="at">css =</span> text_css) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="data2-crawl.html#cb34-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_text</span>()</span>
<span id="cb34-4"><a href="data2-crawl.html#cb34-4" aria-hidden="true" tabindex="-1"></a>html_v</span></code></pre></div>
<pre><code>## [1] &quot;하이퍼텍스트 마크업 언어(HyperText Markup Language, HTML, 문화어: 초본문표식달기언어, 하이퍼본문표식달기언어)는 웹 페이지를 위한 지배적인 마크업 언어다. 또한, HTML은 제목, 단락, 목록 등과 같은 본문을 위한 구조적 의미를 나타내는 것뿐만 아니라 링크, 인용과 그 밖의 항목으로 구조적 문서를 만들 수 있는 방법을 제공한다. 그리고 이미지와 객체를 내장하고 대화형 양식을 생성하는 데 사용될 수 있다. HTML은 웹 페이지 콘텐츠 안의 꺾쇠 괄호에 둘러싸인 \&quot;태그\&quot;로 되어있는 HTML 요소 형태로 작성한다. HTML은 웹 브라우저와 같은 HTML 처리 장치의 행동에 영향을 주는 자바스크립트와 본문과 그 밖의 항목의 외관과 배치를 정의하는 CSS 같은 스크립트를 포함하거나 불러올 수 있다. HTML과 CSS 표준의 공동 책임자인 W3C는 명확하고 표상적인 마크업을 위하여 CSS의 사용을 권장한다.[1]&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data2-crawl.html#cb36-1" aria-hidden="true" tabindex="-1"></a>html_v <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span></code></pre></div>
<pre><code>##  chr &quot;하이퍼텍스트 마크업 언어(HyperText Markup Language, HTML, 문화어: 초본문표식달기언어, 하이퍼본문표식달기언어)는&quot;| __truncated__</code></pre>
<p>문자형벡터로 추출됐다.</p>
<p><code>rvest</code>패키지는 HTML문서의 각 요소에서 내용을 추출할 수 있는 다양한 함수를 제공한다.</p>
<ul>
<li><p><code>html_text()</code> 텍스트 본문 추출</p></li>
<li><p><code>html_table()</code> 테이블 추출</p></li>
<li><p><code>html_attr()</code> 속성 추출</p></li>
<li><p><code>html_attrs()</code> 복수의 속성 추출</p></li>
<li><p><code>html_name()</code> 요소의 태그 이름 추출</p></li>
<li><p><code>html_children()</code> 하부 요소 추출</p></li>
</ul>
</div>
<div id="html_attr-html_attrs" class="section level4" number="7.3.3.2">
<h4><span class="header-section-number">7.3.3.2</span> <code>html_attr()</code> <code>html_attrs()</code></h4>
<p>HTML요소에서 속성의 내용을 추출하기 위해서는 <code>html_attr()</code> 혹은 <code>html_attrs()</code>함수를 이용한다.</p>
<p>위키백과 HTML항목에서 제목이 ’개발’인 본문에 링크된 웹 주소를 추출해보자. 웹주소이므로 <code>a</code>태그인 노드에서 속성의 값이 <code>href</code>인 요소를 지정한다.</p>
<p>본문의 특정 위치는 개발자도구 창 왼쪽 위의 화살표아이콘를 클릭하면 특정 페이지소스를 쉽게 찾을 수 있다(Figure <a href="data2-crawl.html#fig:pgsrc-body">7.9</a>). 화살표아이콘이 파란색으로 바뀐 다음, 본문에 마우스 커서를 놓으면, 해당 페이지소스가 강조된다.</p>
<div class="figure"><span id="fig:pgsrc-body"></span>
<img src="images/pgsrc-body.JPG" alt="본문으로 웹페이지 소스 찾기" width="1182" />
<p class="caption">
Figure 7.9: 본문으로 웹페이지 소스 찾기
</p>
</div>
<p>해당 웹페이지 소스를 찾았으면 ’마우스오른쪽 버튼 -&gt; [Copy] -&gt; [Copy Selector]의 순서로 해당 값을 복사한 다음, <code>html_nodes()</code>함수로 해당 HTLM요소를 찾아, <code>html_attr()</code>함수로 URL을 추출한다.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data2-crawl.html#cb38-1" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; p:nth-child(9) &gt; a:nth-child(1)&#39;</span></span>
<span id="cb38-2"><a href="data2-crawl.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="data2-crawl.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(text_css) <span class="sc">%&gt;%</span>  </span>
<span id="cb38-4"><a href="data2-crawl.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/wiki/%EC%9C%A0%EB%9F%BD_%EC%9E%85%EC%9E%90_%EB%AC%BC%EB%A6%AC_%EC%97%B0%EA%B5%AC%EC%86%8C&quot;</code></pre>
<p>본문에는 링크가 여럿인데, 하나의 링크만 추출됐다. 이유는 속성의 값에서 <code>a:nth-child(1)</code>이 <code>a</code>태그 중 첫번째 것만 지정한 것이기 때문이다.</p>
<p>본문에 있는 모든 링크를 추출하는 것이 목적이므로, <code>a:nth-child(1)</code> 대신 <code>a</code>만 지정한다.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data2-crawl.html#cb40-1" aria-hidden="true" tabindex="-1"></a>link_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="data2-crawl.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; p:nth-child(9) &gt; a&#39;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb40-3"><a href="data2-crawl.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span>
<span id="cb40-4"><a href="data2-crawl.html#cb40-4" aria-hidden="true" tabindex="-1"></a>link_v</span></code></pre></div>
<pre><code>## [1] &quot;/wiki/%EC%9C%A0%EB%9F%BD_%EC%9E%85%EC%9E%90_%EB%AC%BC%EB%A6%AC_%EC%97%B0%EA%B5%AC%EC%86%8C&quot;                        
## [2] &quot;/wiki/%ED%8C%80_%EB%B2%84%EB%84%88%EC%8A%A4%EB%A6%AC&quot;                                                              
## [3] &quot;/w/index.php?title=%EC%9D%B8%EC%BD%B0%EC%9D%B4%EC%96%B4&amp;action=edit&amp;redlink=1&quot;                                     
## [4] &quot;/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7&quot;                                                                                 
## [5] &quot;/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%ED%85%8D%EC%8A%A4%ED%8A%B8&quot;                                                      
## [6] &quot;/w/index.php?title=%EB%A1%9C%EB%B2%84%ED%8A%B8_%EC%B9%B4%EC%9D%BC%EB%A6%AC%EC%95%84%EC%9A%B0&amp;action=edit&amp;redlink=1&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data2-crawl.html#cb42-1" aria-hidden="true" tabindex="-1"></a>link_v <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span></code></pre></div>
<pre><code>##  chr [1:6] &quot;/wiki/%EC%9C%A0%EB%9F%BD_%EC%9E%85%EC%9E%90_%EB%AC%BC%EB%A6%AC_%EC%97%B0%EA%B5%AC%EC%86%8C&quot; ...</code></pre>
<p>해당 본문에 있는 모든 링크가 문자형 벡터로 추출됐다.</p>
<p><code>html_attrs()</code>함수를 이용하면 모든 속성의 내용을 추출할 수 있다.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="data2-crawl.html#cb44-1" aria-hidden="true" tabindex="-1"></a>attr_l <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="data2-crawl.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; p:nth-child(9) &gt; a&#39;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb44-3"><a href="data2-crawl.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attrs</span>()</span>
<span id="cb44-4"><a href="data2-crawl.html#cb44-4" aria-hidden="true" tabindex="-1"></a>attr_l</span></code></pre></div>
<pre><code>## [[1]]
##                                                                                         href 
## &quot;/wiki/%EC%9C%A0%EB%9F%BD_%EC%9E%85%EC%9E%90_%EB%AC%BC%EB%A6%AC_%EC%97%B0%EA%B5%AC%EC%86%8C&quot; 
##                                                                                        title 
##                                                                      &quot;유럽 입자 물리 연구소&quot; 
## 
## [[2]]
##                                                   href 
## &quot;/wiki/%ED%8C%80_%EB%B2%84%EB%84%88%EC%8A%A4%EB%A6%AC&quot; 
##                                                  title 
##                                          &quot;팀 버너스리&quot; 
## 
## [[3]]
##                                                                            href 
## &quot;/w/index.php?title=%EC%9D%B8%EC%BD%B0%EC%9D%B4%EC%96%B4&amp;action=edit&amp;redlink=1&quot; 
##                                                                           class 
##                                                                           &quot;new&quot; 
##                                                                           title 
##                                                          &quot;인콰이어 (없는 문서)&quot; 
## 
## [[4]]
##                                href                               title 
## &quot;/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7&quot;                            &quot;인터넷&quot; 
## 
## [[5]]
##                                                           href 
## &quot;/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%ED%85%8D%EC%8A%A4%ED%8A%B8&quot; 
##                                                          title 
##                                                 &quot;하이퍼텍스트&quot; 
## 
## [[6]]
##                                                                                                                 href 
## &quot;/w/index.php?title=%EB%A1%9C%EB%B2%84%ED%8A%B8_%EC%B9%B4%EC%9D%BC%EB%A6%AC%EC%95%84%EC%9A%B0&amp;action=edit&amp;redlink=1&quot; 
##                                                                                                                class 
##                                                                                                                &quot;new&quot; 
##                                                                                                                title 
##                                                                                      &quot;로버트 카일리아우 (없는 문서)&quot;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="data2-crawl.html#cb46-1" aria-hidden="true" tabindex="-1"></a>attr_l <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span></code></pre></div>
<pre><code>## List of 6
##  $ : Named chr [1:2] &quot;/wiki/%EC%9C%A0%EB%9F%BD_%EC%9E%85%EC%9E%90_%EB%AC%BC%EB%A6%AC_%EC%97%B0%EA%B5%AC%EC%86%8C&quot; &quot;유럽 입자 물리 연구소&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;href&quot; &quot;title&quot;
##  $ : Named chr [1:2] &quot;/wiki/%ED%8C%80_%EB%B2%84%EB%84%88%EC%8A%A4%EB%A6%AC&quot; &quot;팀 버너스리&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;href&quot; &quot;title&quot;
##  $ : Named chr [1:3] &quot;/w/index.php?title=%EC%9D%B8%EC%BD%B0%EC%9D%B4%EC%96%B4&amp;action=edit&amp;redlink=1&quot; &quot;new&quot; &quot;인콰이어 (없는 문서)&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;href&quot; &quot;class&quot; &quot;title&quot;
##  $ : Named chr [1:2] &quot;/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7&quot; &quot;인터넷&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;href&quot; &quot;title&quot;
##  $ : Named chr [1:2] &quot;/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%ED%85%8D%EC%8A%A4%ED%8A%B8&quot; &quot;하이퍼텍스트&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;href&quot; &quot;title&quot;
##  $ : Named chr [1:3] &quot;/w/index.php?title=%EB%A1%9C%EB%B2%84%ED%8A%B8_%EC%B9%B4%EC%9D%BC%EB%A6%AC%EC%95%84%EC%9A%B0&amp;action=edit&amp;redlink=1&quot; &quot;new&quot; &quot;로버트 카일리아우 (없는 문서)&quot;
##   ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;href&quot; &quot;class&quot; &quot;title&quot;</code></pre>
<p>이 문서에 있는 <code>href</code>, <code>class</code>, <code>title</code> 등 3종의 속성 이름과 각 속성의 값이 추출됐다. 산출내용이 리스트 구조에 저장돼 있다.</p>
</div>
<div id="html_table" class="section level4" number="7.3.3.3">
<h4><span class="header-section-number">7.3.3.3</span> <code>html_table()</code></h4>
<p>웹페이지의 내용 중에는 표로 정리된 부분이 있다. 표의 형식을 유지한채로 추출할 수 있는 함수가 <code>html_table()</code>함수다.</p>
<p>HTLM Tutorial인 <a href="https://www.w3schools.com">w3schools.com</a>의 HTML table항목에 있는 표(HTML Table Tags)를 추출해 보자.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="data2-crawl.html#cb48-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.w3schools.com/html/html_tables.asp&quot;</span></span>
<span id="cb48-2"><a href="data2-crawl.html#cb48-2" aria-hidden="true" tabindex="-1"></a>table_tb <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="data2-crawl.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;#main &gt; table&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-4"><a href="data2-crawl.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb48-5"><a href="data2-crawl.html#cb48-5" aria-hidden="true" tabindex="-1"></a>table_tb</span>
<span id="cb48-6"><a href="data2-crawl.html#cb48-6" aria-hidden="true" tabindex="-1"></a>table_tb <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<p>HTML Table Tags를 정리한 표가 리스트 구조 안의 데이터프레임으로 추출됐다. 리스트에서 데이터프레임만 부분선택(subsetting)한다.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data2-crawl.html#cb49-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.w3schools.com/html/html_tables.asp&quot;</span></span>
<span id="cb49-2"><a href="data2-crawl.html#cb49-2" aria-hidden="true" tabindex="-1"></a>table_tb <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="data2-crawl.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;#main &gt; table&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb49-4"><a href="data2-crawl.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb49-5"><a href="data2-crawl.html#cb49-5" aria-hidden="true" tabindex="-1"></a>table_tb</span>
<span id="cb49-6"><a href="data2-crawl.html#cb49-6" aria-hidden="true" tabindex="-1"></a>table_tb[[<span class="dv">1</span>]]</span>
<span id="cb49-7"><a href="data2-crawl.html#cb49-7" aria-hidden="true" tabindex="-1"></a>table_tb[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
</div>
</div>
<div id="user-agent-지정" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> User-Agent 지정</h3>
<p>크롤링을 진행할 때 갑자기 서버 접속이 지연되 오류가 발생하는 경우가 있다. 웹서버에서 크롤링 접속자를 기계(봇)로 간주해 접속을 지연시켰을 가능성이 높다. 이때는 요청정보에 User-Agent를 지정한다.</p>
<p>User-Agent의 값은 POST()방식에서 질의정보를 확보하는 경로를 통해 확보할 수 있다(Figure <a href="data2-crawl.html#fig:f12-ua">7.10</a>). User-Agent항목을 클릭하고, 마우스 오른쪽 버튼을 클릭하면 User-Agent 값을 목사할 수 있다.</p>
<div class="figure"><span id="fig:f12-ua"></span>
<img src="images/f12-ua.JPG" alt="User-Agent 값" width="1331" />
<p class="caption">
Figure 7.10: User-Agent 값
</p>
</div>
<p>앞서 한국학술지인용색인에서 백신으로 검색할 때 사용한 코드에 User-Agent의 값을 넣어 보자. <code>user_agent(agent = )</code>인자를 이용한다.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="data2-crawl.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb50-2"><a href="data2-crawl.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="data2-crawl.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;English&quot;</span>)</span>
<span id="cb50-4"><a href="data2-crawl.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="data2-crawl.html#cb50-5" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&#39;https://www.kci.go.kr/kciportal/po/search/poTotalSearList.kci&#39;</span></span>
<span id="cb50-6"><a href="data2-crawl.html#cb50-6" aria-hidden="true" tabindex="-1"></a>ua <span class="ot">&lt;-</span> <span class="st">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36&#39;</span></span>
<span id="cb50-7"><a href="data2-crawl.html#cb50-7" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">POST</span>(</span>
<span id="cb50-8"><a href="data2-crawl.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  host,</span>
<span id="cb50-9"><a href="data2-crawl.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">body =</span></span>
<span id="cb50-10"><a href="data2-crawl.html#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb50-11"><a href="data2-crawl.html#cb50-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.printKeyword =</span> <span class="st">&#39;백신&#39;</span>,</span>
<span id="cb50-12"><a href="data2-crawl.html#cb50-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.sortName =</span> <span class="st">&#39;SCORE&#39;</span>,</span>
<span id="cb50-13"><a href="data2-crawl.html#cb50-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.sortDir =</span> <span class="st">&#39;desc&#39;</span>,</span>
<span id="cb50-14"><a href="data2-crawl.html#cb50-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.docsCount =</span> <span class="dv">10</span>,</span>
<span id="cb50-15"><a href="data2-crawl.html#cb50-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">poSearchBean.startPg =</span> <span class="dv">1</span>,</span>
<span id="cb50-16"><a href="data2-crawl.html#cb50-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">reSrchCondition =</span> <span class="st">&#39;all&#39;</span>,</span>
<span id="cb50-17"><a href="data2-crawl.html#cb50-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">reSrchKeyword =</span> <span class="st">&#39;백신&#39;</span>,</span>
<span id="cb50-18"><a href="data2-crawl.html#cb50-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">from =</span> <span class="st">&#39;searchFromTotal&#39;</span></span>
<span id="cb50-19"><a href="data2-crawl.html#cb50-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb50-20"><a href="data2-crawl.html#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">user_agent</span>(<span class="at">agent =</span> ua)</span>
<span id="cb50-21"><a href="data2-crawl.html#cb50-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-22"><a href="data2-crawl.html#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="data2-crawl.html#cb50-23" aria-hidden="true" tabindex="-1"></a>url</span>
<span id="cb50-24"><a href="data2-crawl.html#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="data2-crawl.html#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;Korean&quot;</span>)</span></code></pre></div>
<p>응답받은 결과에서 검색한 논문의 URL을 추출하자.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data2-crawl.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="data2-crawl.html#cb51-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;#poArtiSearList&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="data2-crawl.html#cb51-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;p &gt; a&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="data2-crawl.html#cb51-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_attrs</span>()</span></code></pre></div>
<pre><code>## list()</code></pre>
<p>추출한 URL을 보면 URL이 일부만 표시돼 있다. 이처럼 일부만 표시된 URL을 상대URL(relative URL)이라고 한다.</p>
<p>호스트가 포함된 온전한 URL은 절대URL(absolute URL)이라고 한다. 한국학술지인용색인의 호스트는 ’<a href="https://www.kci.go.kr&#39;이므로" class="uri">https://www.kci.go.kr'이므로</a>, <code>str_c()</code>함수를 이용해 호스트와 추출한 URL을 합하면 절대URL을 만들수 있다.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data2-crawl.html#cb53-1" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">&#39;https://www.kci.go.kr&#39;</span></span>
<span id="cb53-2"><a href="data2-crawl.html#cb53-2" aria-hidden="true" tabindex="-1"></a>article_url <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="data2-crawl.html#cb53-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;#poArtiSearList&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="data2-crawl.html#cb53-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;p &gt; a&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="data2-crawl.html#cb53-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_attrs</span>()</span>
<span id="cb53-6"><a href="data2-crawl.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="data2-crawl.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(host, article_url[[<span class="dv">1</span>]])</span></code></pre></div>
</div>
<div id="연습1" class="section level3" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> 연습1</h3>
<ol style="list-style-type: decimal">
<li>다음 뉴스의 2021년 3월 15일자 랭킹뉴스에 있는 기사의 웹주소를 수집하시오. 웹 주소만 수집하므로 단일 속성을 추출하는 <code>html_attr()</code>함수를 이용한다.</li>
</ol>
<p>URL: <a href="https://news.daum.net/ranking/popular?regDate=20210315" class="uri">https://news.daum.net/ranking/popular?regDate=20210315</a></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data2-crawl.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb54-2"><a href="data2-crawl.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb54-3"><a href="data2-crawl.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb54-4"><a href="data2-crawl.html#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="data2-crawl.html#cb54-5" aria-hidden="true" tabindex="-1"></a>ua <span class="ot">&lt;-</span> <span class="st">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36&quot;</span></span>
<span id="cb54-6"><a href="data2-crawl.html#cb54-6" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://news.daum.net/ranking/popular?regDate=20210315&#39;</span></span>
<span id="cb54-7"><a href="data2-crawl.html#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="data2-crawl.html#cb54-8" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url =</span> url, </span>
<span id="cb54-9"><a href="data2-crawl.html#cb54-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">user_agent</span>(<span class="at">agent =</span> ua))</span>
<span id="cb54-10"><a href="data2-crawl.html#cb54-10" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mArticle &gt; div.rank_news &gt; ul.list_news2 &gt; li:nth-child(1) &gt; a&#39;</span></span>
<span id="cb54-11"><a href="data2-crawl.html#cb54-11" aria-hidden="true" tabindex="-1"></a>text_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb54-12"><a href="data2-crawl.html#cb54-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(text_css) <span class="sc">%&gt;%</span> </span>
<span id="cb54-13"><a href="data2-crawl.html#cb54-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span>
<span id="cb54-14"><a href="data2-crawl.html#cb54-14" aria-hidden="true" tabindex="-1"></a>text_v</span></code></pre></div>
<p>주소가 한건만 추출됐다. 기사 목록을 나타내는 속성의 값이 <code>li:nth-child(1)</code> 특정 하부요소만을 지정했기 때문이다. <code>:nth-child(1)</code>를 빼고 <code>li</code>태그만 지정해보자.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data2-crawl.html#cb55-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url =</span> url, </span>
<span id="cb55-2"><a href="data2-crawl.html#cb55-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">user_agent</span>(<span class="at">agent =</span> ua))</span>
<span id="cb55-3"><a href="data2-crawl.html#cb55-3" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mArticle &gt; div.rank_news &gt; ul.list_news2 &gt; li &gt; a&#39;</span></span>
<span id="cb55-4"><a href="data2-crawl.html#cb55-4" aria-hidden="true" tabindex="-1"></a>text_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(res) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="data2-crawl.html#cb55-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(text_css) <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="data2-crawl.html#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_attr</span>(<span class="st">&#39;href&#39;</span>)</span>
<span id="cb55-7"><a href="data2-crawl.html#cb55-7" aria-hidden="true" tabindex="-1"></a>text_v</span></code></pre></div>
<p>랭킹뉴스에 나와 있는 기사의 모든 웹주소가 추출됐다.</p>
<ol start="2" style="list-style-type: decimal">
<li>위키백과에서 ‘월드 와이드 웹’ 항목을 찾아 본문 텍스트를 추출해, 많이 사용한 단어를 막대도표로 시각화하시오.</li>
</ol>
<p>URL: <a href="https://ko.wikipedia.org/wiki/월드_와이드_웹" class="uri">https://ko.wikipedia.org/wiki/월드_와이드_웹</a></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="data2-crawl.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb56-2"><a href="data2-crawl.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-3"><a href="data2-crawl.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb56-4"><a href="data2-crawl.html#cb56-4" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://ko.wikipedia.org/wiki/월드_와이드_웹&#39;</span></span>
<span id="cb56-5"><a href="data2-crawl.html#cb56-5" aria-hidden="true" tabindex="-1"></a>text_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="data2-crawl.html#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;p&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="data2-crawl.html#cb56-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_text</span>()</span>
<span id="cb56-8"><a href="data2-crawl.html#cb56-8" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb56-9"><a href="data2-crawl.html#cb56-9" aria-hidden="true" tabindex="-1"></a>text_tk <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">text =</span> text_v) <span class="sc">%&gt;%</span> </span>
<span id="cb56-10"><a href="data2-crawl.html#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span> </span>
<span id="cb56-11"><a href="data2-crawl.html#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count</span>(word, <span class="at">sort =</span> T)</span>
<span id="cb56-12"><a href="data2-crawl.html#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="data2-crawl.html#cb56-13" aria-hidden="true" tabindex="-1"></a>text_tk <span class="sc">%&gt;%</span> </span>
<span id="cb56-14"><a href="data2-crawl.html#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-15"><a href="data2-crawl.html#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">reorder</span>(word, n)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-16"><a href="data2-crawl.html#cb56-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb56-17"><a href="data2-crawl.html#cb56-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="fu">aes</span>(word, n), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="data2-crawl.html#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>시사인이 2021년 2월 20일 보도한 ’팬데믹 충격에 누군가는 산소호흡기가 필요하다’를 네이버뉴스에 찾아 본문 텍스트를 추출해, 많이 사용한 단어를 막대도표로 시각화 하시오.</li>
</ol>
<p>URL: <a href="https://news.naver.com/main/read.nhn?mode=LSD&amp;mid=sec&amp;sid1=101&amp;oid=308&amp;aid=0000028351" class="uri">https://news.naver.com/main/read.nhn?mode=LSD&amp;mid=sec&amp;sid1=101&amp;oid=308&amp;aid=0000028351</a></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data2-crawl.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb57-2"><a href="data2-crawl.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb57-3"><a href="data2-crawl.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb57-4"><a href="data2-crawl.html#cb57-4" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://news.naver.com/main/read.nhn?mode=LSD&amp;mid=sec&amp;sid1=101&amp;oid=308&amp;aid=0000028351&#39;</span></span>
<span id="cb57-5"><a href="data2-crawl.html#cb57-5" aria-hidden="true" tabindex="-1"></a>text_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb57-6"><a href="data2-crawl.html#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&#39;div._article_body_contents&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-7"><a href="data2-crawl.html#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_text</span>()</span>
<span id="cb57-8"><a href="data2-crawl.html#cb57-8" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb57-9"><a href="data2-crawl.html#cb57-9" aria-hidden="true" tabindex="-1"></a>text_tk <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">text =</span> text_v) <span class="sc">%&gt;%</span> </span>
<span id="cb57-10"><a href="data2-crawl.html#cb57-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span> </span>
<span id="cb57-11"><a href="data2-crawl.html#cb57-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count</span>(word, <span class="at">sort =</span> T)</span>
<span id="cb57-12"><a href="data2-crawl.html#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="data2-crawl.html#cb57-13" aria-hidden="true" tabindex="-1"></a>text_tk <span class="sc">%&gt;%</span> </span>
<span id="cb57-14"><a href="data2-crawl.html#cb57-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-15"><a href="data2-crawl.html#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">reorder</span>(word, n)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-16"><a href="data2-crawl.html#cb57-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-17"><a href="data2-crawl.html#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="fu">aes</span>(word, n), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb57-18"><a href="data2-crawl.html#cb57-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>위키백과에서 매출기준 상위 기업을 정리한 표를 추출하시오.</li>
</ol>
<p>URL: <a href="https://en.wikipedia.org/wiki/List_of_largest_companies_by_revenue" class="uri">https://en.wikipedia.org/wiki/List_of_largest_companies_by_revenue</a></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="data2-crawl.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb58-2"><a href="data2-crawl.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb58-3"><a href="data2-crawl.html#cb58-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://en.wikipedia.org/wiki/List_of_largest_companies_by_revenue&#39;</span></span>
<span id="cb58-4"><a href="data2-crawl.html#cb58-4" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; table&#39;</span></span>
<span id="cb58-5"><a href="data2-crawl.html#cb58-5" aria-hidden="true" tabindex="-1"></a>text_tb <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="data2-crawl.html#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(text_css) <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="data2-crawl.html#cb58-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_table</span>()</span>
<span id="cb58-8"><a href="data2-crawl.html#cb58-8" aria-hidden="true" tabindex="-1"></a>text_tb[[<span class="dv">1</span>]]</span></code></pre></div>
<p>표에 있는 열의 수가 일관되지 않기 때문에 오류가 발생했다. 표의 헤더를 보면, ‘Revenu’와 ’Profit’ 아래 ‘USD millions’가 있다. <code>fill = TRUE</code>인자를 사용해 ’USD millions’ 부분을 <code>NA</code>로 채우겠나고 제안하고 있다.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data2-crawl.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb59-2"><a href="data2-crawl.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-3"><a href="data2-crawl.html#cb59-3" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&#39;https://en.wikipedia.org/wiki/List_of_largest_companies_by_revenue&#39;</span></span>
<span id="cb59-4"><a href="data2-crawl.html#cb59-4" aria-hidden="true" tabindex="-1"></a>text_css <span class="ot">&lt;-</span> <span class="st">&#39;#mw-content-text &gt; div.mw-parser-output &gt; table&#39;</span></span>
<span id="cb59-5"><a href="data2-crawl.html#cb59-5" aria-hidden="true" tabindex="-1"></a>text_tb <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="data2-crawl.html#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(text_css) <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="data2-crawl.html#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-8"><a href="data2-crawl.html#cb59-8" aria-hidden="true" tabindex="-1"></a>text_tb[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##   Rank                     Name    Industry      Revenue       Profit Employees
## 1 Rank                     Name    Industry USD millions USD millions Employees
## 2    1                  Walmart      Retail     $559,200      $19,742 2,200,000
## 3    2                   Amazon      Retail     $386,100      $17,377 1,225,300
## 4    3               State Grid Electricity     $383,906       $7,970   907,677
## 5    4 China National Petroleum Oil and gas     $379,130       $4,433   460,724
##   Country[note 1] Ref
## 1 Country[note 1] Ref
## 2   United States [4]
## 3   United States [5]
## 4           China [6]
## 5           China [7]</code></pre>
<p>매출 상위 기업 목록이 정리된 표를 데이터프레임으로 추출했다.</p>
</div>
</div>
<div id="api" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> API</h2>
<p>API(Application Programming Interface: 응용프로그램 프로그래밍 인터페이스)는 프로그램이 다른 프로그램에 제공하는 일종의 설명서나 메뉴다. 프로그램들 사이에 서로 소통할 수 있도록 도와주는 매개제다. 웹사이트 중에는 API를 제공해 기계가 접근할 수 있는 편의를 제공하는 경우가 있다. 예를 들어, <뉴욕타임즈>의 기사는 유료이므로 공개된 주소로는 크롤링을 할수 없다. <뉴욕타임즈>는 API를 제공해 기사의 일부를 크롤링할 수 있도록 했다.</p>
</div>
<div id="반복작업-for" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> 반복작업 <code>for</code></h2>
<ol start="2" style="list-style-type: decimal">
<li>네이버 학술정보에 ’백신’을 주제어로 2020년 KCI 등재지를 검색하시오. 검색결과의 첫 페이지에 나온 학술 논문의 제목</li>
</ol>
<ul>
<li><a href="https://hyunyulhenry.github.io/quant_cookbook/%ED%81%AC%EB%A1%A4%EB%A7%81%EC%9D%84-%EC%9C%84%ED%95%9C-%EA%B8%B0%EB%B3%B8-%EC%A7%80%EC%8B%9D.html">스크랩에 대한 자세한 설명은 이현열의 <R을 이용한 퀀트 투자폴리오></a> 참고.</li>
</ul>
</div>
<div id="동적웹페이지-rselenium" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> 동적웹페이지 <code>RSelenium</code></h2>
<p>정적 웹페이지는 서버에 있는 내용을 그대로 웹페이지에 전달하기 때문에 브라우저로 파악할 수 있는 URL을 이용해 서버의 내용을 수집할 수 있다.</p>
<p>반면, 동덕 웹페이지는 서버에서 먼저 처리한 내용을 웹페이지에 전달하기 때문에 브라우저로 확보할 수 있는 URL로는 크롤링이 안된다.</p>
<p>동적 웹페이지의 URL을 확보하기 위해서는 셀레늄(Selenium)을 이용할 수 있다.</p>
<p>R에서는 <code>Rselenium</code>패키지를 이용할 수 있다.</p>
<div id="r셀레니움-사용-준비" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> R셀레니움 사용 준비</h3>
<p>먼저 <code>Rselenium</code>패키지 설치.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data2-crawl.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;RSelenium&quot;</span>)</span></code></pre></div>
<p>브라우저는 크롬을 이용한다.
브라우저 버전에 맞는 크롬드라이버 설정.
브라우저 버전과 드라이버 버전이 안맞으면 <code>wdman</code>패키지의 <code>chrome()</code>함수로 브라우저와 셀레늄서버의 포트를 연결할때 브라우저 버전이 맞지 않으면 아래와 같은 오류 메시지가 뜬다.</p>
<pre><code>Selenium message:session not created: This version of ChromeDriver only supports Chrome version 90
Current browser version is 89.0.4389.90 with binary path C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
  (Driver info: chromedriver=90.0.4430.24 (4c6d850f087da467d926e8eddb76550aed655991-refs/branch-heads/4430@{#429}),platform=Windows NT 10.0.19042 x86_64)

에러:      Summary: SessionNotCreatedException
     Detail: A new session could not be created.
     Further Details: run errorDetails method</code></pre>
<p>브라우저 버전은 ’89.0.4389.90’인데. 현재 드라이버는 90버전 이상만 지원한다는 내용이다.</p>
<p><code>binman</code>패키지의 <code>list_versions()</code>함수를 이용해 드라이버 버전을 확인해 브라우저 버전에 맞는 드라이버를 지정해 준다.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data2-crawl.html#cb63-1" aria-hidden="true" tabindex="-1"></a>binman<span class="sc">::</span><span class="fu">list_versions</span>(<span class="at">appname =</span> <span class="st">&quot;chromedriver&quot;</span>)</span></code></pre></div>
<pre><code>## $win32
## [1] &quot;88.0.4324.96&quot; &quot;89.0.4389.23&quot; &quot;90.0.4430.24&quot;</code></pre>
<pre><code>$win32
[1] &quot;88.0.4324.96&quot; &quot;89.0.4389.23&quot;
[3] &quot;90.0.4430.24&quot;</code></pre>
<p>“89.0.4389.23”이 있으므로, <code>wdman</code>패키지의 <code>chrome()</code>으로 드라이버 저벚을 지정해 포트를 연결해 준다. 여기서는 <code>RSelenium</code>안내서에서 사용 한 포트 ‘4445L’으로 설정했다. 만일 ’4500L’ 포트가 안되면 ‘50000L’ ‘50001L’ 등으로 바꿔 해보자.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="data2-crawl.html#cb66-1" aria-hidden="true" tabindex="-1"></a>port <span class="ot">&lt;-</span> 4445L <span class="co"># L은 정수형이라는 의미. L이 없으면 실수형으로 인식. </span></span>
<span id="cb66-2"><a href="data2-crawl.html#cb66-2" aria-hidden="true" tabindex="-1"></a>driver <span class="ot">&lt;-</span> wdman<span class="sc">::</span><span class="fu">chrome</span>(<span class="at">port =</span> port, <span class="at">version =</span> <span class="st">&quot;89.0.4389.23&quot;</span>)</span></code></pre></div>
<p>브라우저를 포트에 연결했으면, <code>Rselenium</code>의 <code>remoteDriver()</code>함수로 브라우저를 실행한 다음 <code>rmt_dr</code>객체에 할당하자. <code>rmt_dr</code>의 구조를 <code>srt()</code>함수로 살펴보자.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data2-crawl.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb67-2"><a href="data2-crawl.html#cb67-2" aria-hidden="true" tabindex="-1"></a>rmt_dr <span class="ot">&lt;-</span> <span class="fu">remoteDriver</span>(<span class="at">port =</span> port, <span class="at">browserName =</span> <span class="st">&quot;chrome&quot;</span>)</span></code></pre></div>
<p><code>rmt_br$open()</code>를 실행해 크롬 브라우저가 실행되면 된다. R셀레늄 이용에 필요한 준비가 마무리 된것이다. 브라우저 상단에 “Chrome”이 자동화된 테스트 소프트웨어에 의해 제어되고 있습니다"는 메시지가 뜬다.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data2-crawl.html#cb68-1" aria-hidden="true" tabindex="-1"></a>rmt_br<span class="sc">$</span><span class="fu">open</span>()</span></code></pre></div>
</div>
<div id="r셀레늄으로-브라우징" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> R셀레늄으로 브라우징</h3>
<p>네이버 뉴스를 R셀레늄으로 검색해보자. <code>rmt_dr$nvigate()</code></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="data2-crawl.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium)</span>
<span id="cb69-2"><a href="data2-crawl.html#cb69-2" aria-hidden="true" tabindex="-1"></a>rmt_dr <span class="ot">&lt;-</span> <span class="fu">remoteDriver</span>(<span class="at">port =</span> port, <span class="at">browserName =</span> <span class="st">&quot;chrome&quot;</span>)</span>
<span id="cb69-3"><a href="data2-crawl.html#cb69-3" aria-hidden="true" tabindex="-1"></a>rmt_dr<span class="sc">$</span><span class="fu">open</span>()</span>
<span id="cb69-4"><a href="data2-crawl.html#cb69-4" aria-hidden="true" tabindex="-1"></a>rmt_dr<span class="sc">$</span><span class="fu">navigate</span>(<span class="st">&quot;https://news.naver.com&quot;</span>)</span></code></pre></div>
<p>이제 <code>Rselenium</code>을 이용해 뉴스를 검색해 보자.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data2-crawl.html#cb70-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> rmt_dr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">&quot;xpath&quot;</span>,</span>
<span id="cb70-2"><a href="data2-crawl.html#cb70-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">value =</span> <span class="st">&#39;//*[@id=&quot;lnb.searchForm&quot;]/fieldset/input[1]&#39;</span>)</span>
<span id="cb70-3"><a href="data2-crawl.html#cb70-3" aria-hidden="true" tabindex="-1"></a>query<span class="sc">$</span><span class="fu">sendKeysToElement</span>( <span class="at">sendKeys =</span> <span class="fu">list</span>(<span class="st">&#39;백신&#39;</span>, <span class="st">&#39;\uE007&#39;</span>) )</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="data2-crawl.html#cb71-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb71-2"><a href="data2-crawl.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="st">https://search.naver.com/search.naver?where=news&amp;query=%EB%B0%B1%EC%8B%A0</span></span>
<span id="cb71-3"><a href="data2-crawl.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;nso=so%3Ar%2Cp%3Afrom20210221to20210221%2Ca%3Aall</span></span>
<span id="cb71-4"><a href="data2-crawl.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb71-5"><a href="data2-crawl.html#cb71-5" aria-hidden="true" tabindex="-1"></a>rmt_dr<span class="sc">$</span><span class="fu">navigate</span>(url)</span>
<span id="cb71-6"><a href="data2-crawl.html#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="data2-crawl.html#cb71-7" aria-hidden="true" tabindex="-1"></a>rmt_dr<span class="sc">$</span><span class="fu">navigate</span>(<span class="st">&quot;https://www.naver.com&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>한국일보가 2021년 2월 21일 ’백신’을 주제로 보도한 기사의 URL을 추출하시오.</li>
</ol>
<p>URL: <a href="https://search.naver.com/search.naver?where=news&amp;query=백신&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.02.21&amp;de=2021.02.21&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210221to20210221%2Ca%3Aall&amp;mynews=1&amp;refresh_start=0&amp;related=0" class="uri">https://search.naver.com/search.naver?where=news&amp;query=백신&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.02.21&amp;de=2021.02.21&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210221to20210221%2Ca%3Aall&amp;mynews=1&amp;refresh_start=0&amp;related=0</a></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="data2-crawl.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb72-2"><a href="data2-crawl.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb72-3"><a href="data2-crawl.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb72-4"><a href="data2-crawl.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb72-5"><a href="data2-crawl.html#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="data2-crawl.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># url &lt;- &#39;https://search.naver.com/search.naver?where=news&amp;query=백신&amp;sm=tab_opt&amp;sort=0&amp;photo=0&amp;field=0&amp;reporter_article=&amp;pd=3&amp;ds=2021.02.21&amp;de=2021.02.21&amp;docid=&amp;nso=so%3Ar%2Cp%3Afrom20210221to20210221%2Ca%3Aall&amp;mynews=1&amp;refresh_start=0&amp;related=0&#39;</span></span>
<span id="cb72-7"><a href="data2-crawl.html#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="data2-crawl.html#cb72-8" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb72-9"><a href="data2-crawl.html#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="st">https://search.naver.com/search.naver?where=news&amp;query=%EB%B0%B1%EC%8B%A0</span></span>
<span id="cb72-10"><a href="data2-crawl.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">&amp;nso=so%3Ar%2Cp%3Afrom20210221to20210221%2Ca%3Aall</span></span>
<span id="cb72-11"><a href="data2-crawl.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb72-12"><a href="data2-crawl.html#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="data2-crawl.html#cb72-13" aria-hidden="true" tabindex="-1"></a>text_v <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb72-14"><a href="data2-crawl.html#cb72-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="st">&quot;#sp_nws1 &gt; div&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-15"><a href="data2-crawl.html#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_text</span>()</span>
<span id="cb72-16"><a href="data2-crawl.html#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="data2-crawl.html#cb72-17" aria-hidden="true" tabindex="-1"></a>text_tk <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">text =</span> text_v) <span class="sc">%&gt;%</span> </span>
<span id="cb72-18"><a href="data2-crawl.html#cb72-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span> </span>
<span id="cb72-19"><a href="data2-crawl.html#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count</span>(word, <span class="at">sort =</span> T)</span>
<span id="cb72-20"><a href="data2-crawl.html#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="data2-crawl.html#cb72-21" aria-hidden="true" tabindex="-1"></a>text_tk <span class="sc">%&gt;%</span> </span>
<span id="cb72-22"><a href="data2-crawl.html#cb72-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-23"><a href="data2-crawl.html#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">reorder</span>(word, n)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-24"><a href="data2-crawl.html#cb72-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb72-25"><a href="data2-crawl.html#cb72-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_col</span>(<span class="fu">aes</span>(word, n), <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-26"><a href="data2-crawl.html#cb72-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>()</span></code></pre></div>
<p>HTML에 대한 자세한 설명서로는 w3school의 <a href="https://www.w3schools.com/html/">HTML tutorial</a>과 웹버스터디의 <a href="http://webberstudy.com">강의</a>가 있다. 생활코딩에서 <a href="https://opentutorials.org/course/3084">무료 강좌</a>를 제공하고 있다.</p>
<p>R웹크롤링은 아래 문서 참조.
<a href="https://statkclee.github.io/ds-intro-2020/data/R_Web_Crawling.pdf" class="uri">https://statkclee.github.io/ds-intro-2020/data/R_Web_Crawling.pdf</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="anal1freq.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clean2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-data2_crawl.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
